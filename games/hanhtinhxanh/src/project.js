window.__require=function e(n,t,i){function s(o,a){if(!t[o]){if(!n[o]){var c=o.split("/");if(c=c[c.length-1],!n[c]){var u="function"==typeof __require&&__require;if(!a&&u)return u(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+o+"'")}}var d=t[o]={exports:{}};n[o][0].call(d.exports,function(e){return s(n[o][1][e]||e)},d,d.exports,e,n,t,i)}return t[o].exports}for(var r="function"==typeof __require&&__require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(e,n,t){"use strict";var i=i||function(e,n){var t={},i=t.lib={},s=function(){},r=i.Base={extend:function(e){s.prototype=this;var n=new s;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=i.WordArray=r.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=void 0!=n?n:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var n=this.words,t=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var s=0;s<e;s++)n[i+s>>>2]|=(t[s>>>2]>>>24-s%4*8&255)<<24-(i+s)%4*8;else if(65535<t.length)for(s=0;s<e;s+=4)n[i+s>>>2]=t[s>>>2];else n.push.apply(n,t);return this.sigBytes+=e,this},clamp:function(){var n=this.words,t=this.sigBytes;n[t>>>2]&=4294967295<<32-t%4*8,n.length=e.ceil(t/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(n){for(var t=[],i=0;i<n;i+=4)t.push(4294967296*e.random()|0);return new o.init(t,n)}}),a=t.enc={},c=a.Hex={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],i=0;i<e;i++){var s=n[i>>>2]>>>24-i%4*8&255;t.push((s>>>4).toString(16)),t.push((15&s).toString(16))}return t.join("")},parse:function(e){for(var n=e.length,t=[],i=0;i<n;i+=2)t[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new o.init(t,n/2)}},u=a.Latin1={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],i=0;i<e;i++)t.push(String.fromCharCode(n[i>>>2]>>>24-i%4*8&255));return t.join("")},parse:function(e){for(var n=e.length,t=[],i=0;i<n;i++)t[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new o.init(t,n)}},d=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},l=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(n){var t=this._data,i=t.words,s=t.sigBytes,r=this.blockSize,a=s/(4*r);if(n=(a=n?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*r,s=e.min(4*n,s),n){for(var c=0;c<n;c+=r)this._doProcessBlock(i,c);c=i.splice(0,n),t.sigBytes-=s}return new o.init(c,s)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=l.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(n,t){return new e.init(t).finalize(n)}},_createHmacHelper:function(e){return function(n,t){return new f.HMAC.init(e,t).finalize(n)}}});var f=t.algo={};return t}(Math);(function(e){for(var n=i,t=(r=n.lib).WordArray,s=r.Hasher,r=n.algo,o=[],a=[],c=function(e){return 4294967296*(e-(0|e))|0},u=2,d=0;64>d;){var l;e:{l=u;for(var f=e.sqrt(l),v=2;v<=f;v++)if(!(l%v)){l=!1;break e}l=!0}l&&(8>d&&(o[d]=c(e.pow(u,.5))),a[d]=c(e.pow(u,1/3)),d++),u++}var m=[];r=r.SHA256=s.extend({_doReset:function(){this._hash=new t.init(o.slice(0))},_doProcessBlock:function(e,n){for(var t=this._hash.words,i=t[0],s=t[1],r=t[2],o=t[3],c=t[4],u=t[5],d=t[6],l=t[7],f=0;64>f;f++){if(16>f)m[f]=0|e[n+f];else{var v=m[f-15],h=m[f-2];m[f]=((v<<25|v>>>7)^(v<<14|v>>>18)^v>>>3)+m[f-7]+((h<<15|h>>>17)^(h<<13|h>>>19)^h>>>10)+m[f-16]}v=l+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&u^~c&d)+a[f]+m[f],h=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&s^i&r^s&r),l=d,d=u,u=c,c=o+v|0,o=r,r=s,s=i,i=v+h|0}t[0]=t[0]+i|0,t[1]=t[1]+s|0,t[2]=t[2]+r|0,t[3]=t[3]+o|0,t[4]=t[4]+c|0,t[5]=t[5]+u|0,t[6]=t[6]+d|0,t[7]=t[7]+l|0},_doFinalize:function(){var n=this._data,t=n.words,i=8*this._nDataBytes,s=8*n.sigBytes;return t[s>>>5]|=128<<24-s%32,t[14+(s+64>>>9<<4)]=e.floor(i/4294967296),t[15+(s+64>>>9<<4)]=i,n.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=s._createHelper(r),n.HmacSHA256=s._createHmacHelper(r)})(Math),function(){var e=i,n=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var i=e.blockSize,s=4*i;t.sigBytes>s&&(t=e.finalize(t)),t.clamp();for(var r=this._oKey=t.clone(),o=this._iKey=t.clone(),a=r.words,c=o.words,u=0;u<i;u++)a[u]^=1549556828,c[u]^=909522486;r.sigBytes=o.sigBytes=s,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var n=this._hasher;return e=n.finalize(e),n.reset(),n.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=i,n=e.lib.WordArray;e.enc.Base64={stringify:function(e){var n=e.words,t=e.sigBytes,i=this._map;e.clamp(),e=[];for(var s=0;s<t;s+=3)for(var r=(n[s>>>2]>>>24-s%4*8&255)<<16|(n[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|n[s+2>>>2]>>>24-(s+2)%4*8&255,o=0;4>o&&s+.75*o<t;o++)e.push(i.charAt(r>>>6*(3-o)&63));if(n=i.charAt(64))for(;e.length%4;)e.push(n);return e.join("")},parse:function(e){var t=e.length,i=this._map;(s=i.charAt(64))&&(-1!=(s=e.indexOf(s))&&(t=s));for(var s=[],r=0,o=0;o<t;o++)if(o%4){var a=i.indexOf(e.charAt(o-1))<<o%4*2,c=i.indexOf(e.charAt(o))>>>6-o%4*2;s[r>>>2]|=(a|c)<<24-r%4*8,r++}return n.create(s,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){(function(e){e[e.Undefined=0]="Undefined",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"})(e.EGAErrorSeverity||(e.EGAErrorSeverity={})),function(e){e[e.Undefined=0]="Undefined",e[e.Male=1]="Male",e[e.Female=2]="Female"}(e.EGAGender||(e.EGAGender={})),function(e){e[e.Undefined=0]="Undefined",e[e.Start=1]="Start",e[e.Complete=2]="Complete",e[e.Fail=3]="Fail"}(e.EGAProgressionStatus||(e.EGAProgressionStatus={})),function(e){e[e.Undefined=0]="Undefined",e[e.Source=1]="Source",e[e.Sink=2]="Sink"}(e.EGAResourceFlowType||(e.EGAResourceFlowType={})),function(e){(function(e){e[e.Undefined=0]="Undefined",e[e.Rejected=1]="Rejected"})(e.EGASdkErrorType||(e.EGASdkErrorType={})),function(e){e[e.NoResponse=0]="NoResponse",e[e.BadResponse=1]="BadResponse",e[e.RequestTimeout=2]="RequestTimeout",e[e.JsonEncodeFailed=3]="JsonEncodeFailed",e[e.JsonDecodeFailed=4]="JsonDecodeFailed",e[e.InternalServerError=5]="InternalServerError",e[e.BadRequest=6]="BadRequest",e[e.Unauthorized=7]="Unauthorized",e[e.UnknownResponseCode=8]="UnknownResponseCode",e[e.Ok=9]="Ok"}(e.EGAHTTPApiResponse||(e.EGAHTTPApiResponse={}))}(e.http||(e.http={}))}(s||(s={}));var s;s.EGAErrorSeverity,s.EGAGender,s.EGAProgressionStatus,s.EGAResourceFlowType;(function(e){(function(e){var n;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Debug=3]="Debug"})(n||(n={}));var t=function(){function e(){e.debugEnabled=!1}return e.setInfoLog=function(n){e.instance.infoLogEnabled=n},e.setVerboseLog=function(n){e.instance.infoLogVerboseEnabled=n},e.i=function(t){if(e.instance.infoLogEnabled){var i="Info/"+e.Tag+": "+t;e.instance.sendNotificationMessage(i,n.Info)}},e.w=function(t){var i="Warning/"+e.Tag+": "+t;e.instance.sendNotificationMessage(i,n.Warning)},e.e=function(t){var i="Error/"+e.Tag+": "+t;e.instance.sendNotificationMessage(i,n.Error)},e.ii=function(t){if(e.instance.infoLogVerboseEnabled){var i="Verbose/"+e.Tag+": "+t;e.instance.sendNotificationMessage(i,n.Info)}},e.d=function(t){if(e.debugEnabled){var i="Debug/"+e.Tag+": "+t;e.instance.sendNotificationMessage(i,n.Debug)}},e.prototype.sendNotificationMessage=function(e,t){switch(t){case n.Error:console.error(e);break;case n.Warning:console.warn(e);break;case n.Debug:"function"==typeof console.debug?console.debug(e):console.log(e);break;case n.Info:console.log(e)}},e.instance=new e,e.Tag="GameAnalytics",e}();e.GALogger=t})(e.logging||(e.logging={}))})(s||(s={})),function(e){(function(n){var t=e.logging.GALogger,s=function(){function e(){}return e.getHmac=function(e,n){var t=i.HmacSHA256(n,e);return i.enc.Base64.stringify(t)},e.stringMatch=function(e,n){return!(!e||!n)&&n.test(e)},e.joinStringArray=function(e,n){for(var t="",i=0,s=e.length;i<s;i++)i>0&&(t+=n),t+=e[i];return t},e.stringArrayContainsString=function(e,n){if(0===e.length)return!1;for(var t in e)if(e[t]===n)return!0;return!1},e.encode64=function(n){n=encodeURI(n);var t,i,s,r,o,a="",c=0,u=0,d=0;do{s=(t=n.charCodeAt(d++))>>2,r=(3&t)<<4|(i=n.charCodeAt(d++))>>4,o=(15&i)<<2|(c=n.charCodeAt(d++))>>6,u=63&c,isNaN(i)?o=u=64:isNaN(c)&&(u=64),a=a+e.keyStr.charAt(s)+e.keyStr.charAt(r)+e.keyStr.charAt(o)+e.keyStr.charAt(u),t=i=c=0,s=r=o=u=0}while(d<n.length);return a},e.decode64=function(n){var i,s,r,o,a="",c=0,u=0,d=0;/[^A-Za-z0-9\+\/\=]/g.exec(n)&&t.w("There were invalid base64 characters in the input text. Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='. Expect errors in decoding."),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{i=e.keyStr.indexOf(n.charAt(d++))<<2|(r=e.keyStr.indexOf(n.charAt(d++)))>>4,s=(15&r)<<4|(o=e.keyStr.indexOf(n.charAt(d++)))>>2,c=(3&o)<<6|(u=e.keyStr.indexOf(n.charAt(d++))),a+=String.fromCharCode(i),64!=o&&(a+=String.fromCharCode(s)),64!=u&&(a+=String.fromCharCode(c)),i=s=c=0,r=o=u=0}while(d<n.length);return decodeURI(a)},e.timeIntervalSince1970=function(){var e=new Date;return Math.round(e.getTime()/1e3)},e.createGuid=function(){return(e.s4()+e.s4()+"-"+e.s4()+"-4"+e.s4().substr(0,3)+"-"+e.s4()+"-"+e.s4()+e.s4()+e.s4()).toLowerCase()},e.s4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},e.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e}();n.GAUtilities=s})(e.utilities||(e.utilities={}))}(s||(s={})),function(e){(function(n){var t=e.logging.GALogger,i=e.http.EGASdkErrorType,s=e.utilities.GAUtilities,r=function(){function n(){}return n.validateBusinessEvent=function(e,i,s,r,o){return n.validateCurrency(e)?i<0?(t.w("Validation fail - business event - amount. Cannot be less than 0. Failed amount: "+i),!1):n.validateShortString(s,!0)?n.validateEventPartLength(r,!1)?n.validateEventPartCharacters(r)?n.validateEventPartLength(o,!1)?!!n.validateEventPartCharacters(o)||(t.w("Validation fail - business event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+o),!1):(t.w("Validation fail - business event - itemId. Cannot be (null), empty or above 64 characters. String: "+o),!1):(t.w("Validation fail - business event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+r),!1):(t.w("Validation fail - business event - itemType: Cannot be (null), empty or above 64 characters. String: "+r),!1):(t.w("Validation fail - business event - cartType. Cannot be above 32 length. String: "+s),!1):(t.w("Validation fail - business event - currency: Cannot be (null) and need to be A-Z, 3 characters and in the standard at openexchangerates.org. Failed currency: "+e),!1)},n.validateResourceEvent=function(i,r,o,a,c,u,d){return i==e.EGAResourceFlowType.Undefined?(t.w("Validation fail - resource event - flowType: Invalid flow type."),!1):r?s.stringArrayContainsString(u,r)?o>0?a?n.validateEventPartLength(a,!1)?n.validateEventPartCharacters(a)?s.stringArrayContainsString(d,a)?n.validateEventPartLength(c,!1)?!!n.validateEventPartCharacters(c)||(t.w("Validation fail - resource event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+c),!1):(t.w("Validation fail - resource event - itemId: Cannot be (null), empty or above 64 characters. String: "+c),!1):(t.w("Validation fail - resource event - itemType: Not found in list of pre-defined available resource itemTypes. String: "+a),!1):(t.w("Validation fail - resource event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+a),!1):(t.w("Validation fail - resource event - itemType: Cannot be (null), empty or above 64 characters. String: "+a),!1):(t.w("Validation fail - resource event - itemType: Cannot be (null)"),!1):(t.w("Validation fail - resource event - amount: Float amount cannot be 0 or negative. Value: "+o),!1):(t.w("Validation fail - resource event - currency: Not found in list of pre-defined available resource currencies. String: "+r),!1):(t.w("Validation fail - resource event - currency: Cannot be (null)"),!1)},n.validateProgressionEvent=function(i,s,r,o){if(i==e.EGAProgressionStatus.Undefined)return t.w("Validation fail - progression event: Invalid progression status."),!1;if(o&&!r&&s)return t.w("Validation fail - progression event: 03 found but 01+02 are invalid. Progression must be set as either 01, 01+02 or 01+02+03."),!1;if(r&&!s)return t.w("Validation fail - progression event: 02 found but not 01. Progression must be set as either 01, 01+02 or 01+02+03"),!1;if(!s)return t.w("Validation fail - progression event: progression01 not valid. Progressions must be set as either 01, 01+02 or 01+02+03"),!1;if(!n.validateEventPartLength(s,!1))return t.w("Validation fail - progression event - progression01: Cannot be (null), empty or above 64 characters. String: "+s),!1;if(!n.validateEventPartCharacters(s))return t.w("Validation fail - progression event - progression01: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+s),!1;if(r){if(!n.validateEventPartLength(r,!0))return t.w("Validation fail - progression event - progression02: Cannot be empty or above 64 characters. String: "+r),!1;if(!n.validateEventPartCharacters(r))return t.w("Validation fail - progression event - progression02: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+r),!1}if(o){if(!n.validateEventPartLength(o,!0))return t.w("Validation fail - progression event - progression03: Cannot be empty or above 64 characters. String: "+o),!1;if(!n.validateEventPartCharacters(o))return t.w("Validation fail - progression event - progression03: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+o),!1}return!0},n.validateDesignEvent=function(e,i){return n.validateEventIdLength(e)?!!n.validateEventIdCharacters(e)||(t.w("Validation fail - design event - eventId: Non valid characters. Only allowed A-z, 0-9, -_., ()!?. String: "+e),!1):(t.w("Validation fail - design event - eventId: Cannot be (null) or empty. Only 5 event parts allowed seperated by :. Each part need to be 32 characters or less. String: "+e),!1)},n.validateErrorEvent=function(i,s){return i==e.EGAErrorSeverity.Undefined?(t.w("Validation fail - error event - severity: Severity was unsupported value."),!1):!!n.validateLongString(s,!0)||(t.w("Validation fail - error event - message: Message cannot be above 8192 characters."),!1)},n.validateSdkErrorEvent=function(e,s,r){return!!n.validateKeys(e,s)&&(r!==i.Undefined||(t.w("Validation fail - sdk error event - type: Type was unsupported value."),!1))},n.validateKeys=function(e,n){return!(!s.stringMatch(e,/^[A-z0-9]{32}$/)||!s.stringMatch(n,/^[A-z0-9]{40}$/))},n.validateCurrency=function(e){return!!e&&!!s.stringMatch(e,/^[A-Z]{3}$/)},n.validateEventPartLength=function(e,n){return!(!n||e)||!!e&&!(e.length>64)},n.validateEventPartCharacters=function(e){return!!s.stringMatch(e,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}$/)},n.validateEventIdLength=function(e){return!!e&&!!s.stringMatch(e,/^[^:]{1,64}(?::[^:]{1,64}){0,4}$/)},n.validateEventIdCharacters=function(e){return!!e&&!!s.stringMatch(e,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}(:[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}){0,4}$/)},n.validateAndCleanInitRequestResponse=function(e){if(null==e)return t.w("validateInitRequestResponse failed - no response dictionary."),null;var n={};try{n.enabled=e.enabled}catch(e){return t.w("validateInitRequestResponse failed - invalid type in 'enabled' field."),null}try{var i=e.server_ts;if(!(i>0))return t.w("validateInitRequestResponse failed - invalid value in 'server_ts' field."),null;n.server_ts=i}catch(n){return t.w("validateInitRequestResponse failed - invalid type in 'server_ts' field. type="+typeof e.server_ts+", value="+e.server_ts+", "+n),null}try{var s=e.configurations;n.configurations=s}catch(n){return t.w("validateInitRequestResponse failed - invalid type in 'configurations' field. type="+typeof e.configurations+", value="+e.configurations+", "+n),null}return n},n.validateBuild=function(e){return!!n.validateShortString(e,!1)},n.validateSdkWrapperVersion=function(e){return!!s.stringMatch(e,/^(unity|unreal|gamemaker|cocos2d|construct|defold) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/)},n.validateEngineVersion=function(e){return!(!e||!s.stringMatch(e,/^(unity|unreal|gamemaker|cocos2d|construct|defold) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/))},n.validateUserId=function(e){return!!n.validateString(e,!1)||(t.w("Validation fail - user id: id cannot be (null), empty or above 64 characters."),!1)},n.validateShortString=function(e,n){return!(!n||e)||!(!e||e.length>32)},n.validateString=function(e,n){return!(!n||e)||!(!e||e.length>64)},n.validateLongString=function(e,n){return!(!n||e)||!(!e||e.length>8192)},n.validateConnectionType=function(e){return s.stringMatch(e,/^(wwan|wifi|lan|offline)$/)},n.validateCustomDimensions=function(e){return n.validateArrayOfStrings(20,32,!1,"custom dimensions",e)},n.validateResourceCurrencies=function(e){if(!n.validateArrayOfStrings(20,64,!1,"resource currencies",e))return!1;for(var i=0;i<e.length;++i)if(!s.stringMatch(e[i],/^[A-Za-z]+$/))return t.w("resource currencies validation failed: a resource currency can only be A-Z, a-z. String was: "+e[i]),!1;return!0},n.validateResourceItemTypes=function(e){if(!n.validateArrayOfStrings(20,32,!1,"resource item types",e))return!1;for(var i=0;i<e.length;++i)if(!n.validateEventPartCharacters(e[i]))return t.w("resource item types validation failed: a resource item type cannot contain other characters than A-z, 0-9, -_., ()!?. String was: "+e[i]),!1;return!0},n.validateDimension01=function(e,n){return!e||!!s.stringArrayContainsString(n,e)},n.validateDimension02=function(e,n){return!e||!!s.stringArrayContainsString(n,e)},n.validateDimension03=function(e,n){return!e||!!s.stringArrayContainsString(n,e)},n.validateArrayOfStrings=function(e,n,i,s,r){var o=s;if(o||(o="Array"),!r)return t.w(o+" validation failed: array cannot be null. "),!1;if(0==i&&0==r.length)return t.w(o+" validation failed: array cannot be empty. "),!1;if(e>0&&r.length>e)return t.w(o+" validation failed: array cannot exceed "+e+" values. It has "+r.length+" values."),!1;for(var a=0;a<r.length;++a){var c=r[a]?r[a].length:0;if(0===c)return t.w(o+" validation failed: contained an empty string. Array="+JSON.stringify(r)),!1;if(n>0&&c>n)return t.w(o+" validation failed: a string exceeded max allowed length (which is: "+n+"). String was: "+r[a]),!1}return!0},n.validateFacebookId=function(e){return!!n.validateString(e,!1)||(t.w("Validation fail - facebook id: id cannot be (null), empty or above 64 characters."),!1)},n.validateGender=function(n){if(isNaN(Number(e.EGAGender[n]))){if(n==e.EGAGender.Undefined||n!=e.EGAGender.Male&&n!=e.EGAGender.Female)return t.w("Validation fail - gender: Has to be 'male' or 'female'. Was: "+n),!1}else if(n==e.EGAGender[e.EGAGender.Undefined]||n!=e.EGAGender[e.EGAGender.Male]&&n!=e.EGAGender[e.EGAGender.Female])return t.w("Validation fail - gender: Has to be 'male' or 'female'. Was: "+n),!1;return!0},n.validateBirthyear=function(e){return!(e<0||e>9999)||(t.w("Validation fail - birthYear: Cannot be (null) or invalid range."),!1)},n.validateClientTs=function(e){return!(e<-4294967294||e>4294967294)},n}();n.GAValidator=r})(e.validators||(e.validators={}))}(s||(s={})),function(e){(function(e){var n=function(){return function(e,n,t){this.name=e,this.value=n,this.version=t}}();e.NameValueVersion=n;var t=function(){return function(e,n){this.name=e,this.version=n}}();e.NameVersion=t;var i=function(){function e(){}return e.touch=function(){},e.getRelevantSdkVersion=function(){return e.sdkGameEngineVersion?e.sdkGameEngineVersion:e.sdkWrapperVersion},e.getConnectionType=function(){return e.connectionType},e.updateConnectionType=function(){navigator.onLine?"ios"===e.buildPlatform||"android"===e.buildPlatform?e.connectionType="wwan":e.connectionType="lan":e.connectionType="offline"},e.getOSVersionString=function(){return e.buildPlatform+" "+e.osVersionPair.version},e.runtimePlatformToString=function(){return e.osVersionPair.name},e.getBrowserVersionString=function(){var n,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|ubrowser|msie|trident|fbav(?=\/))\/?\s*(\d+)/i)||[];if(0==i.length&&"ios"===e.buildPlatform)return"webkit_"+e.osVersion;if(/trident/i.test(i[1]))return"IE "+((n=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||"");if("Chrome"===i[1]&&null!=(n=t.match(/\b(OPR|Edge|UBrowser)\/(\d+)/)))return n.slice(1).join(" ").replace("OPR","Opera").replace("UBrowser","UC").toLowerCase();if(i[1]&&"fbav"===i[1].toLowerCase()&&(i[1]="facebook",i[2]))return"facebook "+i[2];var s=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"];return null!=(n=t.match(/version\/(\d+)/i))&&s.splice(1,1,n[1]),s.join(" ").toLowerCase()},e.getDeviceModel=function(){return"unknown"},e.getDeviceManufacturer=function(){return"unknown"},e.matchItem=function(e,n){var i,s,r,o,a=new t("unknown","0.0.0"),c=0,u=0;for(c=0;c<n.length;c+=1)if(new RegExp(n[c].value,"i").test(e)){if(i=new RegExp(n[c].version+"[- /:;]([\\d._]+)","i"),o="",(s=e.match(i))&&s[1]&&(r=s[1]),r){var d=r.split(/[._]+/);for(u=0;u<Math.min(d.length,3);u+=1)o+=d[u]+(u<Math.min(d.length,3)-1?".":"")}else o="0.0.0";return a.name=n[c].name,a.version=o,a}return a},e.sdkWrapperVersion="javascript 3.1.2",e.osVersionPair=e.matchItem([navigator.platform,navigator.userAgent,navigator.appVersion,navigator.vendor].join(" "),[new n("windows_phone","Windows Phone","OS"),new n("windows","Win","NT"),new n("ios","iPhone","OS"),new n("ios","iPad","OS"),new n("ios","iPod","OS"),new n("android","Android","Android"),new n("blackBerry","BlackBerry","/"),new n("mac_osx","Mac","OS X"),new n("tizen","Tizen","Tizen"),new n("linux","Linux","rv")]),e.buildPlatform=e.runtimePlatformToString(),e.deviceModel=e.getDeviceModel(),e.deviceManufacturer=e.getDeviceManufacturer(),e.osVersion=e.getOSVersionString(),e.browserVersion=e.getBrowserVersionString(),e.maxSafeInteger=Math.pow(2,53)-1,e}();e.GADevice=i})(e.device||(e.device={}))}(s||(s={})),function(e){(function(e){var n=function(){function e(n){this.deadline=n,this.ignore=!1,this.async=!1,this.running=!1,this.id=++e.idCounter}return e.idCounter=0,e}();e.TimedBlock=n})(e.threading||(e.threading={}))}(s||(s={})),function(e){(function(e){var n=function(){function e(e){this.comparer=e,this._subQueues={},this._sortedKeys=[]}return e.prototype.enqueue=function(e,n){-1===this._sortedKeys.indexOf(e)&&this.addQueueOfPriority(e),this._subQueues[e].push(n)},e.prototype.addQueueOfPriority=function(e){var n=this;this._sortedKeys.push(e),this._sortedKeys.sort(function(e,t){return n.comparer.compare(e,t)}),this._subQueues[e]=[]},e.prototype.peek=function(){if(this.hasItems())return this._subQueues[this._sortedKeys[0]][0];throw new Error("The queue is empty")},e.prototype.hasItems=function(){return this._sortedKeys.length>0},e.prototype.dequeue=function(){if(this.hasItems())return this.dequeueFromHighPriorityQueue();throw new Error("The queue is empty")},e.prototype.dequeueFromHighPriorityQueue=function(){var e=this._sortedKeys[0],n=this._subQueues[e].shift();return 0===this._subQueues[e].length&&(this._sortedKeys.shift(),delete this._subQueues[e]),n},e}();e.PriorityQueue=n})(e.threading||(e.threading={}))}(s||(s={})),function(e){(function(n){var t,i,s=e.logging.GALogger;(function(e){e[e.Equal=0]="Equal",e[e.LessOrEqual=1]="LessOrEqual",e[e.NotEqual=2]="NotEqual"})(t=n.EGAStoreArgsOperator||(n.EGAStoreArgsOperator={})),function(e){e[e.Events=0]="Events",e[e.Sessions=1]="Sessions",e[e.Progression=2]="Progression"}(i=n.EGAStore||(n.EGAStore={}));var r=function(){function e(){this.eventsStore=[],this.sessionsStore=[],this.progressionStore=[],this.storeItems={};try{"object"==typeof localStorage?(localStorage.setItem("testingLocalStorage","yes"),localStorage.removeItem("testingLocalStorage"),e.storageAvailable=!0):e.storageAvailable=!1}catch(e){}}return e.isStorageAvailable=function(){return e.storageAvailable},e.isStoreTooLargeForEvents=function(){return e.instance.eventsStore.length+e.instance.sessionsStore.length>e.MaxNumberOfEntries},e.select=function(n,i,s,r){void 0===i&&(i=[]),void 0===s&&(s=!1),void 0===r&&(r=0);var o=e.getStore(n);if(!o)return null;for(var a=[],c=0;c<o.length;++c){for(var u=o[c],d=!0,l=0;l<i.length;++l){var f=i[l];if(u[f[0]])switch(f[1]){case t.Equal:d=u[f[0]]==f[2];break;case t.LessOrEqual:d=u[f[0]]<=f[2];break;case t.NotEqual:d=u[f[0]]!=f[2];break;default:d=!1}else d=!1;if(!d)break}d&&a.push(u)}return s&&a.sort(function(e,n){return e.client_ts-n.client_ts}),r>0&&a.length>r&&(a=a.slice(0,r+1)),a},e.update=function(n,i,s){void 0===s&&(s=[]);var r=e.getStore(n);if(!r)return!1;for(var o=0;o<r.length;++o){for(var a=r[o],c=!0,u=0;u<s.length;++u){var d=s[u];if(a[d[0]])switch(d[1]){case t.Equal:c=a[d[0]]==d[2];break;case t.LessOrEqual:c=a[d[0]]<=d[2];break;case t.NotEqual:c=a[d[0]]!=d[2];break;default:c=!1}else c=!1;if(!c)break}if(c)for(u=0;u<i.length;++u){var l=i[u];a[l[0]]=l[1]}}return!0},e.delete=function(n,i){var s=e.getStore(n);if(s)for(var r=0;r<s.length;++r){for(var o=s[r],a=!0,c=0;c<i.length;++c){var u=i[c];if(o[u[0]])switch(u[1]){case t.Equal:a=o[u[0]]==u[2];break;case t.LessOrEqual:a=o[u[0]]<=u[2];break;case t.NotEqual:a=o[u[0]]!=u[2];break;default:a=!1}else a=!1;if(!a)break}a&&(s.splice(r,1),--r)}},e.insert=function(n,t,i,s){void 0===i&&(i=!1),void 0===s&&(s=null);var r=e.getStore(n);if(r)if(i){if(!s)return;for(var o=!1,a=0;a<r.length;++a){var c=r[a];if(c[s]==t[s]){for(var u in t)c[u]=t[u];o=!0;break}}o||r.push(t)}else r.push(t)},e.save=function(){e.isStorageAvailable()?(localStorage.setItem(e.KeyPrefix+e.EventsStoreKey,JSON.stringify(e.instance.eventsStore)),localStorage.setItem(e.KeyPrefix+e.SessionsStoreKey,JSON.stringify(e.instance.sessionsStore)),localStorage.setItem(e.KeyPrefix+e.ProgressionStoreKey,JSON.stringify(e.instance.progressionStore)),localStorage.setItem(e.KeyPrefix+e.ItemsStoreKey,JSON.stringify(e.instance.storeItems))):s.w("Storage is not available, cannot save.")},e.load=function(){if(e.isStorageAvailable()){try{e.instance.eventsStore=JSON.parse(localStorage.getItem(e.KeyPrefix+e.EventsStoreKey)),e.instance.eventsStore||(e.instance.eventsStore=[])}catch(n){s.w("Load failed for 'events' store. Using empty store."),e.instance.eventsStore=[]}try{e.instance.sessionsStore=JSON.parse(localStorage.getItem(e.KeyPrefix+e.SessionsStoreKey)),e.instance.sessionsStore||(e.instance.sessionsStore=[])}catch(n){s.w("Load failed for 'sessions' store. Using empty store."),e.instance.sessionsStore=[]}try{e.instance.progressionStore=JSON.parse(localStorage.getItem(e.KeyPrefix+e.ProgressionStoreKey)),e.instance.progressionStore||(e.instance.progressionStore=[])}catch(n){s.w("Load failed for 'progression' store. Using empty store."),e.instance.progressionStore=[]}try{e.instance.storeItems=JSON.parse(localStorage.getItem(e.KeyPrefix+e.ItemsStoreKey)),e.instance.storeItems||(e.instance.storeItems={})}catch(n){s.w("Load failed for 'items' store. Using empty store."),e.instance.progressionStore=[]}}else s.w("Storage is not available, cannot load.")},e.setItem=function(n,t){var i=e.KeyPrefix+n;t?e.instance.storeItems[i]=t:i in e.instance.storeItems&&delete e.instance.storeItems[i]},e.getItem=function(n){var t=e.KeyPrefix+n;return t in e.instance.storeItems?e.instance.storeItems[t]:null},e.getStore=function(n){switch(n){case i.Events:return e.instance.eventsStore;case i.Sessions:return e.instance.sessionsStore;case i.Progression:return e.instance.progressionStore;default:return s.w("GAStore.getStore(): Cannot find store: "+n),null}},e.instance=new e,e.MaxNumberOfEntries=2e3,e.KeyPrefix="GA::",e.EventsStoreKey="ga_event",e.SessionsStoreKey="ga_session",e.ProgressionStoreKey="ga_progression",e.ItemsStoreKey="ga_items",e}();n.GAStore=r})(e.store||(e.store={}))}(s||(s={})),function(e){(function(n){var t=e.validators.GAValidator,i=e.utilities.GAUtilities,s=e.logging.GALogger,r=e.store.GAStore,o=e.device.GADevice,a=e.store.EGAStore,c=e.store.EGAStoreArgsOperator,u=function(){function n(){this.availableCustomDimensions01=[],this.availableCustomDimensions02=[],this.availableCustomDimensions03=[],this.availableResourceCurrencies=[],this.availableResourceItemTypes=[],this.configurations={},this.commandCenterListeners=[],this.sdkConfigDefault={},this.sdkConfig={},this.progressionTries={},this._isEventSubmissionEnabled=!0}return n.setUserId=function(e){n.instance.userId=e,n.cacheIdentifier()},n.getIdentifier=function(){return n.instance.identifier},n.isInitialized=function(){return n.instance.initialized},n.setInitialized=function(e){n.instance.initialized=e},n.getSessionStart=function(){return n.instance.sessionStart},n.getSessionNum=function(){return n.instance.sessionNum},n.getTransactionNum=function(){return n.instance.transactionNum},n.getSessionId=function(){return n.instance.sessionId},n.getCurrentCustomDimension01=function(){return n.instance.currentCustomDimension01},n.getCurrentCustomDimension02=function(){return n.instance.currentCustomDimension02},n.getCurrentCustomDimension03=function(){return n.instance.currentCustomDimension03},n.getGameKey=function(){return n.instance.gameKey},n.getGameSecret=function(){return n.instance.gameSecret},n.getAvailableCustomDimensions01=function(){return n.instance.availableCustomDimensions01},n.setAvailableCustomDimensions01=function(e){t.validateCustomDimensions(e)&&(n.instance.availableCustomDimensions01=e,n.validateAndFixCurrentDimensions(),s.i("Set available custom01 dimension values: ("+i.joinStringArray(e,", ")+")"))},n.getAvailableCustomDimensions02=function(){return n.instance.availableCustomDimensions02},n.setAvailableCustomDimensions02=function(e){t.validateCustomDimensions(e)&&(n.instance.availableCustomDimensions02=e,n.validateAndFixCurrentDimensions(),s.i("Set available custom02 dimension values: ("+i.joinStringArray(e,", ")+")"))},n.getAvailableCustomDimensions03=function(){return n.instance.availableCustomDimensions03},n.setAvailableCustomDimensions03=function(e){t.validateCustomDimensions(e)&&(n.instance.availableCustomDimensions03=e,n.validateAndFixCurrentDimensions(),s.i("Set available custom03 dimension values: ("+i.joinStringArray(e,", ")+")"))},n.getAvailableResourceCurrencies=function(){return n.instance.availableResourceCurrencies},n.setAvailableResourceCurrencies=function(e){t.validateResourceCurrencies(e)&&(n.instance.availableResourceCurrencies=e,s.i("Set available resource currencies: ("+i.joinStringArray(e,", ")+")"))},n.getAvailableResourceItemTypes=function(){return n.instance.availableResourceItemTypes},n.setAvailableResourceItemTypes=function(e){t.validateResourceItemTypes(e)&&(n.instance.availableResourceItemTypes=e,s.i("Set available resource item types: ("+i.joinStringArray(e,", ")+")"))},n.getBuild=function(){return n.instance.build},n.setBuild=function(e){n.instance.build=e,s.i("Set build version: "+e)},n.getUseManualSessionHandling=function(){return n.instance.useManualSessionHandling},n.isEventSubmissionEnabled=function(){return n.instance._isEventSubmissionEnabled},n.prototype.setDefaultId=function(e){this.defaultUserId=e||"",n.cacheIdentifier()},n.getDefaultId=function(){return n.instance.defaultUserId},n.getSdkConfig=function(){var e=0;for(var t in n.instance.sdkConfig)0===e&&(i=t),++e;if(i&&e>0)return n.instance.sdkConfig;var i;e=0;for(var t in n.instance.sdkConfigCached)0===e&&(i=t),++e;return i&&e>0?n.instance.sdkConfigCached:n.instance.sdkConfigDefault},n.isEnabled=function(){var e=n.getSdkConfig();return(!e.enabled||"false"!=e.enabled)&&!!n.instance.initAuthorized},n.setCustomDimension01=function(e){n.instance.currentCustomDimension01=e,r.setItem(n.Dimension01Key,e),s.i("Set custom01 dimension value: "+e)},n.setCustomDimension02=function(e){n.instance.currentCustomDimension02=e,r.setItem(n.Dimension02Key,e),s.i("Set custom02 dimension value: "+e)},n.setCustomDimension03=function(e){n.instance.currentCustomDimension03=e,r.setItem(n.Dimension03Key,e),s.i("Set custom03 dimension value: "+e)},n.setFacebookId=function(e){n.instance.facebookId=e,r.setItem(n.FacebookIdKey,e),s.i("Set facebook id: "+e)},n.setGender=function(t){n.instance.gender=isNaN(Number(e.EGAGender[t]))?e.EGAGender[t].toString().toLowerCase():e.EGAGender[e.EGAGender[t]].toString().toLowerCase(),r.setItem(n.GenderKey,n.instance.gender),s.i("Set gender: "+n.instance.gender)},n.setBirthYear=function(e){n.instance.birthYear=e,r.setItem(n.BirthYearKey,e.toString()),s.i("Set birth year: "+e)},n.incrementSessionNum=function(){var e=n.getSessionNum()+1;n.instance.sessionNum=e},n.incrementTransactionNum=function(){var e=n.getTransactionNum()+1;n.instance.transactionNum=e},n.incrementProgressionTries=function(e){var t=n.getProgressionTries(e)+1;n.instance.progressionTries[e]=t;var i={};i.progression=e,i.tries=t,r.insert(a.Progression,i,!0,"progression")},n.getProgressionTries=function(e){return e in n.instance.progressionTries?n.instance.progressionTries[e]:0},n.clearProgressionTries=function(e){e in n.instance.progressionTries&&delete n.instance.progressionTries[e];var t=[];t.push(["progression",c.Equal,e]),r.delete(a.Progression,t)},n.setKeys=function(e,t){n.instance.gameKey=e,n.instance.gameSecret=t},n.setManualSessionHandling=function(e){n.instance.useManualSessionHandling=e,s.i("Use manual session handling: "+e)},n.setEnabledEventSubmission=function(e){n.instance._isEventSubmissionEnabled=e},n.getEventAnnotations=function(){var e={v:2};e.user_id=n.instance.identifier,e.client_ts=n.getClientTsAdjusted(),e.sdk_version=o.getRelevantSdkVersion(),e.os_version=o.osVersion,e.manufacturer=o.deviceManufacturer,e.device=o.deviceModel,e.browser_version=o.browserVersion,e.platform=o.buildPlatform,e.session_id=n.instance.sessionId,e[n.SessionNumKey]=n.instance.sessionNum;var i=o.getConnectionType();return t.validateConnectionType(i)&&(e.connection_type=i),o.gameEngineVersion&&(e.engine_version=o.gameEngineVersion),n.instance.build&&(e.build=n.instance.build),n.instance.facebookId&&(e[n.FacebookIdKey]=n.instance.facebookId),n.instance.gender&&(e[n.GenderKey]=n.instance.gender),0!=n.instance.birthYear&&(e[n.BirthYearKey]=n.instance.birthYear),e},n.getSdkErrorEventAnnotations=function(){var e={v:2};e.category=n.CategorySdkError,e.sdk_version=o.getRelevantSdkVersion(),e.os_version=o.osVersion,e.manufacturer=o.deviceManufacturer,e.device=o.deviceModel,e.platform=o.buildPlatform;var i=o.getConnectionType();return t.validateConnectionType(i)&&(e.connection_type=i),o.gameEngineVersion&&(e.engine_version=o.gameEngineVersion),e},n.getInitAnnotations=function(){var e={};return e.user_id=n.getIdentifier(),e.sdk_version=o.getRelevantSdkVersion(),e.os_version=o.osVersion,e.platform=o.buildPlatform,e},n.getClientTsAdjusted=function(){var e=i.timeIntervalSince1970(),s=e+n.instance.clientServerTimeOffset;return t.validateClientTs(s)?s:e},n.sessionIsStarted=function(){return 0!=n.instance.sessionStart},n.cacheIdentifier=function(){n.instance.userId?n.instance.identifier=n.instance.userId:n.instance.defaultUserId&&(n.instance.identifier=n.instance.defaultUserId)},n.ensurePersistedStates=function(){r.isStorageAvailable()&&r.load();var e=n.instance;e.setDefaultId(null!=r.getItem(n.DefaultUserIdKey)?r.getItem(n.DefaultUserIdKey):i.createGuid()),e.sessionNum=null!=r.getItem(n.SessionNumKey)?Number(r.getItem(n.SessionNumKey)):0,e.transactionNum=null!=r.getItem(n.TransactionNumKey)?Number(r.getItem(n.TransactionNumKey)):0,e.facebookId?r.setItem(n.FacebookIdKey,e.facebookId):(e.facebookId=null!=r.getItem(n.FacebookIdKey)?r.getItem(n.FacebookIdKey):"",e.facebookId),e.gender?r.setItem(n.GenderKey,e.gender):(e.gender=null!=r.getItem(n.GenderKey)?r.getItem(n.GenderKey):"",e.gender),e.birthYear&&0!=e.birthYear?r.setItem(n.BirthYearKey,e.birthYear.toString()):(e.birthYear=null!=r.getItem(n.BirthYearKey)?Number(r.getItem(n.BirthYearKey)):0,e.birthYear),e.currentCustomDimension01?r.setItem(n.Dimension01Key,e.currentCustomDimension01):(e.currentCustomDimension01=null!=r.getItem(n.Dimension01Key)?r.getItem(n.Dimension01Key):"",e.currentCustomDimension01),e.currentCustomDimension02?r.setItem(n.Dimension02Key,e.currentCustomDimension02):(e.currentCustomDimension02=null!=r.getItem(n.Dimension02Key)?r.getItem(n.Dimension02Key):"",e.currentCustomDimension02),e.currentCustomDimension03?r.setItem(n.Dimension03Key,e.currentCustomDimension03):(e.currentCustomDimension03=null!=r.getItem(n.Dimension03Key)?r.getItem(n.Dimension03Key):"",e.currentCustomDimension03);var t=null!=r.getItem(n.SdkConfigCachedKey)?r.getItem(n.SdkConfigCachedKey):"";if(t){var s=JSON.parse(i.decode64(t));s&&(e.sdkConfigCached=s)}var o=r.select(a.Progression);if(o)for(var c=0;c<o.length;++c){var u=o[c];u&&(e.progressionTries[u.progression]=u.tries)}},n.calculateServerTimeOffset=function(e){return e-i.timeIntervalSince1970()},n.validateAndCleanCustomFields=function(e){var t={};if(e){var r=0;for(var o in e){var a=e[o];if(o&&a)if(r<n.MAX_CUSTOM_FIELDS_COUNT){var c=new RegExp("^[a-zA-Z0-9_]{1,"+n.MAX_CUSTOM_FIELDS_KEY_LENGTH+"}$");if(i.stringMatch(o,c)){var u=typeof a;if("string"===u||a instanceof String){var d=a;d.length<=n.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH&&d.length>0?(t[o]=d,++r):s.w("validateAndCleanCustomFields: entry with key="+o+", value="+a+" has been omitted because its value is an empty string or exceeds the max number of characters ("+n.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH+")")}else if("number"===u||a instanceof Number){var l=a;t[o]=l,++r}else s.w("validateAndCleanCustomFields: entry with key="+o+", value="+a+" has been omitted because its value is not a string or number")}else s.w("validateAndCleanCustomFields: entry with key="+o+", value="+a+" has been omitted because its key contains illegal character, is empty or exceeds the max number of characters ("+n.MAX_CUSTOM_FIELDS_KEY_LENGTH+")")}else s.w("validateAndCleanCustomFields: entry with key="+o+", value="+a+" has been omitted because it exceeds the max number of custom fields ("+n.MAX_CUSTOM_FIELDS_COUNT+")");else s.w("validateAndCleanCustomFields: entry with key="+o+", value="+a+" has been omitted because its key or value is null")}}return t},n.validateAndFixCurrentDimensions=function(){t.validateDimension01(n.getCurrentCustomDimension01(),n.getAvailableCustomDimensions01())||n.setCustomDimension01(""),t.validateDimension02(n.getCurrentCustomDimension02(),n.getAvailableCustomDimensions02())||n.setCustomDimension02(""),t.validateDimension03(n.getCurrentCustomDimension03(),n.getAvailableCustomDimensions03())||n.setCustomDimension03("")},n.getConfigurationStringValue=function(e,t){return n.instance.configurations[e]?n.instance.configurations[e].toString():t},n.isCommandCenterReady=function(){return n.instance.commandCenterIsReady},n.addCommandCenterListener=function(e){n.instance.commandCenterListeners.indexOf(e)<0&&n.instance.commandCenterListeners.push(e)},n.removeCommandCenterListener=function(e){var t=n.instance.commandCenterListeners.indexOf(e);t>-1&&n.instance.commandCenterListeners.splice(t,1)},n.getConfigurationsContentAsString=function(){return JSON.stringify(n.instance.configurations)},n.populateConfigurations=function(e){var t=e.configurations;if(t)for(var i=0;i<t.length;++i){var s=t[i];if(s){var r=s.key,o=s.value,a=s.start?s.start:Number.MIN_VALUE,c=s.end?s.end:Number.MAX_VALUE,u=n.getClientTsAdjusted();r&&o&&u>a&&u<c&&(n.instance.configurations[r]=o)}}n.instance.commandCenterIsReady=!0;var d=n.instance.commandCenterListeners;for(i=0;i<d.length;++i)d[i]&&d[i].onCommandCenterUpdated()},n.CategorySdkError="sdk_error",n.MAX_CUSTOM_FIELDS_COUNT=50,n.MAX_CUSTOM_FIELDS_KEY_LENGTH=64,n.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH=256,n.instance=new n,n.DefaultUserIdKey="default_user_id",n.SessionNumKey="session_num",n.TransactionNumKey="transaction_num",n.FacebookIdKey="facebook_id",n.GenderKey="gender",n.BirthYearKey="birth_year",n.Dimension01Key="dimension01",n.Dimension02Key="dimension02",n.Dimension03Key="dimension03",n.SdkConfigCachedKey="sdk_config_cached",n}();n.GAState=u})(e.state||(e.state={}))}(s||(s={})),function(e){(function(n){var t=e.utilities.GAUtilities,i=e.logging.GALogger,s=function(){function e(){}return e.execute=function(n,s,r,o){if(e.countMap[s]||(e.countMap[s]=0),!(e.countMap[s]>=e.MaxCount)){var a=t.getHmac(o,r),c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState){if(!c.responseText)return;if(200!=c.status)return void i.w("sdk error failed. response code not 200. status code: "+c.status+", description: "+c.statusText+", body: "+c.responseText);e.countMap[s]=e.countMap[s]+1}},c.open("POST",n,!0),c.setRequestHeader("Content-Type","application/json"),c.setRequestHeader("Authorization",a);try{c.send(r)}catch(e){console.error(e)}}},e.MaxCount=10,e.countMap={},e}();n.SdkErrorTask=s})(e.tasks||(e.tasks={}))}(s||(s={})),function(e){(function(n){var t=e.state.GAState,i=e.logging.GALogger,s=e.utilities.GAUtilities,r=e.validators.GAValidator,o=e.tasks.SdkErrorTask,a=function(){function e(){this.protocol="https",this.hostName="api.gameanalytics.com",this.version="v2",this.baseUrl=this.protocol+"://"+this.hostName+"/"+this.version,this.initializeUrlPath="init",this.eventsUrlPath="events",this.useGzip=!1}return e.prototype.requestInit=function(i){var s=t.getGameKey(),r=(this.baseUrl,this.initializeUrlPath);r="https://rubick.gameanalytics.com/v2/command_center?game_key="+s+"&interval_seconds=1000000";var o=t.getInitAnnotations(),a=JSON.stringify(o);if(a){var c=this.createPayloadData(a,this.useGzip),u=[];u.push(a),e.sendRequest(r,c,u,this.useGzip,e.initRequestCallback,i)}else i(n.EGAHTTPApiResponse.JsonEncodeFailed,null)},e.prototype.sendEventsInArray=function(i,s,r){if(0!=i.length){var o=t.getGameKey(),a=this.baseUrl+"/"+o+"/"+this.eventsUrlPath,c=JSON.stringify(i);if(c){var u=this.createPayloadData(c,this.useGzip),d=[];d.push(c),d.push(s),d.push(i.length.toString()),e.sendRequest(a,u,d,this.useGzip,e.sendEventInArrayRequestCallback,r)}else r(n.EGAHTTPApiResponse.JsonEncodeFailed,null,s,i.length)}},e.prototype.sendSdkErrorEvent=function(n){if(t.isEventSubmissionEnabled()){var s=t.getGameKey(),a=t.getGameSecret();if(r.validateSdkErrorEvent(s,a,n)){var c,u=this.baseUrl+"/"+s+"/"+this.eventsUrlPath,d=t.getSdkErrorEventAnnotations(),l=e.sdkErrorTypeToString(n);d.type=l;var f=[];f.push(d),(c=JSON.stringify(f))?o.execute(u,n,c,a):i.w("sendSdkErrorEvent: JSON encoding failed.")}}},e.sendEventInArrayRequestCallback=function(t,i,s,r){void 0===r&&(r=null);r[0],r[1];var o,a,c=r[2],u=parseInt(r[3]);o=t.responseText,a=t.status;var d=e.instance.processRequestResponse(a,t.statusText,o,"Events");if(d==n.EGAHTTPApiResponse.Ok||d==n.EGAHTTPApiResponse.BadRequest){var l=o?JSON.parse(o):{};null!=l?(n.EGAHTTPApiResponse.BadRequest,s(d,l,c,u)):s(n.EGAHTTPApiResponse.JsonDecodeFailed,null,c,u)}else s(d,null,c,u)},e.sendRequest=function(e,n,i,r,o,a){var c=new XMLHttpRequest,u=t.getGameSecret(),d=s.getHmac(u,n),l=[];for(var f in l.push(d),i)l.push(i[f]);if(c.onreadystatechange=function(){4===c.readyState&&o(c,e,a,l)},c.open("POST",e,!0),c.setRequestHeader("Content-Type","text/plain"),c.setRequestHeader("Authorization",d),r)throw new Error("gzip not supported");try{c.send(n)}catch(e){console.error(e.stack)}},e.initRequestCallback=function(t,i,s,o){void 0===o&&(o=null);var a,c;o[0],o[1];a=t.responseText,c=t.status;var u=a?JSON.parse(a):{},d=e.instance.processRequestResponse(c,t.statusText,a,"Init");if(d==n.EGAHTTPApiResponse.Ok||d==n.EGAHTTPApiResponse.BadRequest)if(null!=u)if(d!==n.EGAHTTPApiResponse.BadRequest){var l=r.validateAndCleanInitRequestResponse(u);l?s(n.EGAHTTPApiResponse.Ok,l,"",0):s(n.EGAHTTPApiResponse.BadResponse,null,"",0)}else s(d,null,"",0);else s(n.EGAHTTPApiResponse.JsonDecodeFailed,null,"",0);else s(d,null,"",0)},e.prototype.createPayloadData=function(e,n){if(n)throw new Error("gzip not supported");return e},e.prototype.processRequestResponse=function(e,t,i,s){return i?200===e?n.EGAHTTPApiResponse.Ok:0===e||401===e?n.EGAHTTPApiResponse.Unauthorized:400===e?n.EGAHTTPApiResponse.BadRequest:500===e?n.EGAHTTPApiResponse.InternalServerError:n.EGAHTTPApiResponse.UnknownResponseCode:n.EGAHTTPApiResponse.NoResponse},e.sdkErrorTypeToString=function(e){switch(e){case n.EGASdkErrorType.Rejected:return"rejected";default:return""}},e.instance=new e,e}();n.GAHTTPApi=a})(e.http||(e.http={}))}(s||(s={})),function(e){(function(n){var t=e.store.GAStore,i=e.store.EGAStore,s=e.store.EGAStoreArgsOperator,r=e.state.GAState,o=e.logging.GALogger,a=e.utilities.GAUtilities,c=e.http.EGAHTTPApiResponse,u=e.http.GAHTTPApi,d=e.validators.GAValidator,l=e.http.EGASdkErrorType,f=function(){function n(){}return n.addSessionStartEvent=function(){if(r.isEventSubmissionEnabled()){var e={};e.category=n.CategorySessionStart,r.incrementSessionNum(),t.setItem(r.SessionNumKey,r.getSessionNum().toString()),n.addDimensionsToEvent(e),n.addEventToStore(e),o.i("Add SESSION START event"),n.processEvents(n.CategorySessionStart,!1)}},n.addSessionEndEvent=function(){if(r.isEventSubmissionEnabled()){var e=r.getSessionStart(),t=r.getClientTsAdjusted()-e;t<0&&(o.w("Session length was calculated to be less then 0. Should not be possible. Resetting to 0."),t=0);var i={};i.category=n.CategorySessionEnd,i.length=t,n.addDimensionsToEvent(i),n.addEventToStore(i),o.i("Add SESSION END event."),n.processEvents("",!1)}},n.addBusinessEvent=function(e,i,s,a,c,f){if(void 0===c&&(c=null),r.isEventSubmissionEnabled())if(d.validateBusinessEvent(e,i,c,s,a)){var v={};r.incrementTransactionNum(),t.setItem(r.TransactionNumKey,r.getTransactionNum().toString()),v.event_id=s+":"+a,v.category=n.CategoryBusiness,v.currency=e,v.amount=i,v[r.TransactionNumKey]=r.getTransactionNum(),c&&(v.cart_type=c),n.addDimensionsToEvent(v),n.addFieldsToEvent(v,r.validateAndCleanCustomFields(f)),o.i("Add BUSINESS event: {currency:"+e+", amount:"+i+", itemType:"+s+", itemId:"+a+", cartType:"+c+"}"),n.addEventToStore(v)}else u.instance.sendSdkErrorEvent(l.Rejected)},n.addResourceEvent=function(t,i,s,a,c,f){if(r.isEventSubmissionEnabled())if(d.validateResourceEvent(t,i,s,a,c,r.getAvailableResourceCurrencies(),r.getAvailableResourceItemTypes())){t===e.EGAResourceFlowType.Sink&&(s*=-1);var v={},m=n.resourceFlowTypeToString(t);v.event_id=m+":"+i+":"+a+":"+c,v.category=n.CategoryResource,v.amount=s,n.addDimensionsToEvent(v),n.addFieldsToEvent(v,r.validateAndCleanCustomFields(f)),o.i("Add RESOURCE event: {currency:"+i+", amount:"+s+", itemType:"+a+", itemId:"+c+"}"),n.addEventToStore(v)}else u.instance.sendSdkErrorEvent(l.Rejected)},n.addProgressionEvent=function(t,i,s,a,c,f,v){if(r.isEventSubmissionEnabled()){var m=n.progressionStatusToString(t);if(d.validateProgressionEvent(t,i,s,a)){var h,g={};h=s?a?i+":"+s+":"+a:i+":"+s:i,g.category=n.CategoryProgression,g.event_id=m+":"+h;var p=0;f&&t!=e.EGAProgressionStatus.Start&&(g.score=c),t===e.EGAProgressionStatus.Fail&&r.incrementProgressionTries(h),t===e.EGAProgressionStatus.Complete&&(r.incrementProgressionTries(h),p=r.getProgressionTries(h),g.attempt_num=p,r.clearProgressionTries(h)),n.addDimensionsToEvent(g),n.addFieldsToEvent(g,r.validateAndCleanCustomFields(v)),o.i("Add PROGRESSION event: {status:"+m+", progression01:"+i+", progression02:"+s+", progression03:"+a+", score:"+c+", attempt:"+p+"}"),n.addEventToStore(g)}else u.instance.sendSdkErrorEvent(l.Rejected)}},n.addDesignEvent=function(e,t,i,s){if(r.isEventSubmissionEnabled())if(d.validateDesignEvent(e,t)){var a={};a.category=n.CategoryDesign,a.event_id=e,i&&(a.value=t),n.addDimensionsToEvent(a),n.addFieldsToEvent(a,r.validateAndCleanCustomFields(s)),o.i("Add DESIGN event: {eventId:"+e+", value:"+t+"}"),n.addEventToStore(a)}else u.instance.sendSdkErrorEvent(l.Rejected)},n.addErrorEvent=function(e,t,i){if(r.isEventSubmissionEnabled()){var s=n.errorSeverityToString(e);if(d.validateErrorEvent(e,t)){var a={};a.category=n.CategoryError,a.severity=s,a.message=t,n.addDimensionsToEvent(a),n.addFieldsToEvent(a,r.validateAndCleanCustomFields(i)),o.i("Add ERROR event: {severity:"+s+", message:"+t+"}"),n.addEventToStore(a)}else u.instance.sendSdkErrorEvent(l.Rejected)}},n.processEvents=function(e,c){if(r.isEventSubmissionEnabled())try{var d=a.createGuid();c&&(n.cleanupEvents(),n.fixMissingSessionEndEvents());var l=[];l.push(["status",s.Equal,"new"]);var f=[];f.push(["status",s.Equal,"new"]),e&&(l.push(["category",s.Equal,e]),f.push(["category",s.Equal,e]));var v=[];v.push(["status",d]);var m=t.select(i.Events,l);if(!m||0==m.length)return o.i("Event queue: No events to send"),void n.updateSessionStore();if(m.length>n.MaxEventCount){if(!(m=t.select(i.Events,l,!0,n.MaxEventCount)))return;var h=m[m.length-1].client_ts;if(l.push(["client_ts",s.LessOrEqual,h]),!(m=t.select(i.Events,l)))return;f.push(["client_ts",s.LessOrEqual,h])}if(o.i("Event queue: Sending "+m.length+" events."),!t.update(i.Events,v,f))return;for(var g=[],p=0;p<m.length;++p){var S=m[p],y=JSON.parse(a.decode64(S.event));0!=y.length&&g.push(y)}u.instance.sendEventsInArray(g,d,n.processEventsCallback)}catch(e){o.e("Error during ProcessEvents(): "+e.stack)}},n.processEventsCallback=function(e,n,r,a){var u=[];if(u.push(["status",s.Equal,r]),e===c.Ok)t.delete(i.Events,u),o.i("Event queue: "+a+" events sent.");else if(e===c.NoResponse){var d=[];d.push(["status","new"]),o.w("Event queue: Failed to send events to collector - Retrying next time"),t.update(i.Events,d,u)}else{if(n){var l,f=0;for(var v in n)0==f&&(l=n[v]),++f;e===c.BadRequest&&l.constructor===Array?o.w("Event queue: "+a+" events sent. "+f+" events failed GA server validation."):o.w("Event queue: Failed to send events.")}else o.w("Event queue: Failed to send events.");t.delete(i.Events,u)}},n.cleanupEvents=function(){t.update(i.Events,[["status","new"]])},n.fixMissingSessionEndEvents=function(){if(r.isEventSubmissionEnabled()){var e=[];e.push(["session_id",s.NotEqual,r.getSessionId()]);var c=t.select(i.Sessions,e);if(c&&0!=c.length){o.i(c.length+" session(s) located with missing session_end event.");for(var u=0;u<c.length;++u){var d=JSON.parse(a.decode64(c[u].event)),l=d.client_ts-c[u].timestamp;l=Math.max(0,l),d.category=n.CategorySessionEnd,d.length=l,n.addEventToStore(d)}}}},n.addEventToStore=function(e){if(r.isEventSubmissionEnabled())if(r.isInitialized())try{if(t.isStoreTooLargeForEvents()&&!a.stringMatch(e.category,/^(user|session_end|business)$/))return void o.w("Database too large. Event has been blocked.");var c=r.getEventAnnotations(),u=a.encode64(JSON.stringify(c));for(var d in e)c[d]=e[d];var l=JSON.stringify(c);o.ii("Event added to queue: "+l);var f={status:"new"};f.category=c.category,f.session_id=c.session_id,f.client_ts=c.client_ts,f.event=a.encode64(JSON.stringify(c)),t.insert(i.Events,f),e.category==n.CategorySessionEnd?t.delete(i.Sessions,[["session_id",s.Equal,c.session_id]]):((f={}).session_id=c.session_id,f.timestamp=r.getSessionStart(),f.event=u,t.insert(i.Sessions,f,!0,"session_id")),t.isStorageAvailable()&&t.save()}catch(d){o.e("addEventToStore: error"),o.e(d.stack)}else o.w("Could not add event: SDK is not initialized")},n.updateSessionStore=function(){if(r.sessionIsStarted()){var e={};e.session_id=r.instance.sessionId,e.timestamp=r.getSessionStart(),e.event=a.encode64(JSON.stringify(r.getEventAnnotations())),t.insert(i.Sessions,e,!0,"session_id"),t.isStorageAvailable()&&t.save()}},n.addDimensionsToEvent=function(e){e&&(r.getCurrentCustomDimension01()&&(e.custom_01=r.getCurrentCustomDimension01()),r.getCurrentCustomDimension02()&&(e.custom_02=r.getCurrentCustomDimension02()),r.getCurrentCustomDimension03()&&(e.custom_03=r.getCurrentCustomDimension03()))},n.addFieldsToEvent=function(e,n){e&&n&&Object.keys(n).length>0&&(e.custom_fields=n)},n.resourceFlowTypeToString=function(n){return n==e.EGAResourceFlowType.Source||n==e.EGAResourceFlowType[e.EGAResourceFlowType.Source]?"Source":n==e.EGAResourceFlowType.Sink||n==e.EGAResourceFlowType[e.EGAResourceFlowType.Sink]?"Sink":""},n.progressionStatusToString=function(n){return n==e.EGAProgressionStatus.Start||n==e.EGAProgressionStatus[e.EGAProgressionStatus.Start]?"Start":n==e.EGAProgressionStatus.Complete||n==e.EGAProgressionStatus[e.EGAProgressionStatus.Complete]?"Complete":n==e.EGAProgressionStatus.Fail||n==e.EGAProgressionStatus[e.EGAProgressionStatus.Fail]?"Fail":""},n.errorSeverityToString=function(n){return n==e.EGAErrorSeverity.Debug||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Debug]?"debug":n==e.EGAErrorSeverity.Info||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Info]?"info":n==e.EGAErrorSeverity.Warning||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Warning]?"warning":n==e.EGAErrorSeverity.Error||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Error]?"error":n==e.EGAErrorSeverity.Critical||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Critical]?"critical":""},n.instance=new n,n.CategorySessionStart="user",n.CategorySessionEnd="session_end",n.CategoryDesign="design",n.CategoryBusiness="business",n.CategoryProgression="progression",n.CategoryResource="resource",n.CategoryError="error",n.MaxEventCount=500,n}();n.GAEvents=f})(e.events||(e.events={}))}(s||(s={})),function(e){(function(n){var t=e.logging.GALogger,i=e.state.GAState,s=e.events.GAEvents,r=function(){function e(){this.blocks=new n.PriorityQueue({compare:function(e,n){return e-n}}),this.id2TimedBlockMap={},e.startThread()}return e.createTimedBlock=function(e){void 0===e&&(e=0);var t=new Date;return t.setSeconds(t.getSeconds()+e),new n.TimedBlock(t)},e.performTaskOnGAThread=function(t,i){void 0===i&&(i=0);var s=new Date;s.setSeconds(s.getSeconds()+i);var r=new n.TimedBlock(s);r.block=t,e.instance.id2TimedBlockMap[r.id]=r,e.instance.addTimedBlock(r)},e.performTimedBlockOnGAThread=function(n){e.instance.id2TimedBlockMap[n.id]=n,e.instance.addTimedBlock(n)},e.scheduleTimer=function(t,i){var s=new Date;s.setSeconds(s.getSeconds()+t);var r=new n.TimedBlock(s);return r.block=i,e.instance.id2TimedBlockMap[r.id]=r,e.instance.addTimedBlock(r),r.id},e.getTimedBlockById=function(n){return n in e.instance.id2TimedBlockMap?e.instance.id2TimedBlockMap[n]:null},e.ensureEventQueueIsRunning=function(){e.instance.keepRunning=!0,e.instance.isRunning||(e.instance.isRunning=!0,e.scheduleTimer(e.ProcessEventsIntervalInSeconds,e.processEventQueue))},e.endSessionAndStopQueue=function(){i.isInitialized()&&(t.i("Ending session."),e.stopEventQueue(),i.isEnabled()&&i.sessionIsStarted()&&(s.addSessionEndEvent(),i.instance.sessionStart=0))},e.stopEventQueue=function(){e.instance.keepRunning=!1},e.ignoreTimer=function(n){n in e.instance.id2TimedBlockMap&&(e.instance.id2TimedBlockMap[n].ignore=!0)},e.setEventProcessInterval=function(n){n>0&&(e.ProcessEventsIntervalInSeconds=n)},e.prototype.addTimedBlock=function(e){this.blocks.enqueue(e.deadline.getTime(),e)},e.run=function(){clearTimeout(e.runTimeoutId);try{for(var n;n=e.getNextBlock();)if(!n.ignore)if(n.async){if(!n.running){n.running=!0,n.block();break}}else n.block();return void(e.runTimeoutId=setTimeout(e.run,e.ThreadWaitTimeInMs))}catch(e){t.e("Error on GA thread"),t.e(e.stack)}},e.startThread=function(){e.runTimeoutId=setTimeout(e.run,0)},e.getNextBlock=function(){var n=new Date;return e.instance.blocks.hasItems()&&e.instance.blocks.peek().deadline.getTime()<=n.getTime()?e.instance.blocks.peek().async&&e.instance.blocks.peek().running?e.instance.blocks.peek():e.instance.blocks.dequeue():null},e.processEventQueue=function(){s.processEvents("",!0),e.instance.keepRunning?e.scheduleTimer(e.ProcessEventsIntervalInSeconds,e.processEventQueue):e.instance.isRunning=!1},e.instance=new e,e.ThreadWaitTimeInMs=1e3,e.ProcessEventsIntervalInSeconds=8,e}();n.GAThreading=r})(e.threading||(e.threading={}))}(s||(s={})),function(e){var n=e.threading.GAThreading,t=e.logging.GALogger,i=e.store.GAStore,s=e.state.GAState,r=e.http.GAHTTPApi,o=e.device.GADevice,a=e.validators.GAValidator,c=e.http.EGAHTTPApiResponse,u=e.utilities.GAUtilities,d=e.events.GAEvents,l=function(){function l(){}return l.init=function(){if(o.touch(),l.methodMap.configureAvailableCustomDimensions01=l.configureAvailableCustomDimensions01,l.methodMap.configureAvailableCustomDimensions02=l.configureAvailableCustomDimensions02,l.methodMap.configureAvailableCustomDimensions03=l.configureAvailableCustomDimensions03,l.methodMap.configureAvailableResourceCurrencies=l.configureAvailableResourceCurrencies,l.methodMap.configureAvailableResourceItemTypes=l.configureAvailableResourceItemTypes,l.methodMap.configureBuild=l.configureBuild,l.methodMap.configureSdkGameEngineVersion=l.configureSdkGameEngineVersion,l.methodMap.configureGameEngineVersion=l.configureGameEngineVersion,l.methodMap.configureUserId=l.configureUserId,l.methodMap.initialize=l.initialize,l.methodMap.addBusinessEvent=l.addBusinessEvent,l.methodMap.addResourceEvent=l.addResourceEvent,l.methodMap.addProgressionEvent=l.addProgressionEvent,l.methodMap.addDesignEvent=l.addDesignEvent,l.methodMap.addErrorEvent=l.addErrorEvent,l.methodMap.addErrorEvent=l.addErrorEvent,l.methodMap.setEnabledInfoLog=l.setEnabledInfoLog,l.methodMap.setEnabledVerboseLog=l.setEnabledVerboseLog,l.methodMap.setEnabledManualSessionHandling=l.setEnabledManualSessionHandling,l.methodMap.setEnabledEventSubmission=l.setEnabledEventSubmission,l.methodMap.setCustomDimension01=l.setCustomDimension01,l.methodMap.setCustomDimension02=l.setCustomDimension02,l.methodMap.setCustomDimension03=l.setCustomDimension03,l.methodMap.setFacebookId=l.setFacebookId,l.methodMap.setGender=l.setGender,l.methodMap.setBirthYear=l.setBirthYear,l.methodMap.setEventProcessInterval=l.setEventProcessInterval,l.methodMap.startSession=l.startSession,l.methodMap.endSession=l.endSession,l.methodMap.onStop=l.onStop,l.methodMap.onResume=l.onResume,l.methodMap.addCommandCenterListener=l.addCommandCenterListener,l.methodMap.removeCommandCenterListener=l.removeCommandCenterListener,l.methodMap.getCommandCenterValueAsString=l.getCommandCenterValueAsString,l.methodMap.isCommandCenterReady=l.isCommandCenterReady,l.methodMap.getConfigurationsContentAsString=l.getConfigurationsContentAsString,"undefined"!=typeof window&&void 0!==window.GameAnalytics&&void 0!==window.GameAnalytics.q){var e=window.GameAnalytics.q;for(var n in e)l.gaCommand.apply(null,e[n])}},l.gaCommand=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];n.length>0&&n[0]in e.GameAnalytics.methodMap&&(n.length>1?e.GameAnalytics.methodMap[n[0]].apply(null,Array.prototype.slice.call(n,1)):e.GameAnalytics.methodMap[n[0]]())},l.configureAvailableCustomDimensions01=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!1)?t.w("Available custom dimensions must be set before SDK is initialized"):s.setAvailableCustomDimensions01(e)})},l.configureAvailableCustomDimensions02=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!1)?t.w("Available custom dimensions must be set before SDK is initialized"):s.setAvailableCustomDimensions02(e)})},l.configureAvailableCustomDimensions03=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!1)?t.w("Available custom dimensions must be set before SDK is initialized"):s.setAvailableCustomDimensions03(e)})},l.configureAvailableResourceCurrencies=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!1)?t.w("Available resource currencies must be set before SDK is initialized"):s.setAvailableResourceCurrencies(e)})},l.configureAvailableResourceItemTypes=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!1)?t.w("Available resource item types must be set before SDK is initialized"):s.setAvailableResourceItemTypes(e)})},l.configureBuild=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!1)?t.w("Build version must be set before SDK is initialized."):a.validateBuild(e)?s.setBuild(e):t.i("Validation fail - configure build: Cannot be null, empty or above 32 length. String: "+e)})},l.configureSdkGameEngineVersion=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!1)||(a.validateSdkWrapperVersion(e)?o.sdkGameEngineVersion=e:t.i("Validation fail - configure sdk version: Sdk version not supported. String: "+e))})},l.configureGameEngineVersion=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!1)||(a.validateEngineVersion(e)?o.gameEngineVersion=e:t.i("Validation fail - configure game engine version: Game engine version not supported. String: "+e))})},l.configureUserId=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!1)?t.w("A custom user id must be set before SDK is initialized."):a.validateUserId(e)?s.setUserId(e):t.i("Validation fail - configure user_id: Cannot be null, empty or above 64 length. Will use default user_id method. Used string: "+e)})},l.initialize=function(e,i){void 0===e&&(e=""),void 0===i&&(i=""),o.updateConnectionType();var r=n.createTimedBlock();r.async=!0,l.initTimedBlockId=r.id,r.block=function(){l.isSdkReady(!0,!1)?t.w("SDK already initialized. Can only be called once."):a.validateKeys(e,i)?(s.setKeys(e,i),l.internalInitialize()):t.w("SDK failed initialize. Game key or secret key is invalid. Can only contain characters A-z 0-9, gameKey is 32 length, gameSecret is 40 length. Failed keys - gameKey: "+e+", secretKey: "+i)},n.performTimedBlockOnGAThread(r)},l.addBusinessEvent=function(e,t,i,s,r){void 0===e&&(e=""),void 0===t&&(t=0),void 0===i&&(i=""),void 0===s&&(s=""),void 0===r&&(r=""),o.updateConnectionType(),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!0,"Could not add business event")&&d.addBusinessEvent(e,t,i,s,r,{})})},l.addResourceEvent=function(t,i,s,r,a){void 0===t&&(t=e.EGAResourceFlowType.Undefined),void 0===i&&(i=""),void 0===s&&(s=0),void 0===r&&(r=""),void 0===a&&(a=""),o.updateConnectionType(),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!0,"Could not add resource event")&&d.addResourceEvent(t,i,s,r,a,{})})},l.addProgressionEvent=function(t,i,s,r,a){void 0===t&&(t=e.EGAProgressionStatus.Undefined),void 0===i&&(i=""),void 0===s&&(s=""),void 0===r&&(r=""),o.updateConnectionType(),n.performTaskOnGAThread(function(){if(l.isSdkReady(!0,!0,"Could not add progression event")){var e="number"==typeof a;d.addProgressionEvent(t,i,s,r,e?a:0,e,{})}})},l.addDesignEvent=function(e,t){o.updateConnectionType(),n.performTaskOnGAThread(function(){if(l.isSdkReady(!0,!0,"Could not add design event")){var n="number"==typeof t;d.addDesignEvent(e,n?t:0,n,{})}})},l.addErrorEvent=function(t,i){void 0===t&&(t=e.EGAErrorSeverity.Undefined),void 0===i&&(i=""),o.updateConnectionType(),n.performTaskOnGAThread(function(){l.isSdkReady(!0,!0,"Could not add error event")&&d.addErrorEvent(t,i,{})})},l.setEnabledInfoLog=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread(function(){e?(t.setInfoLog(e),t.i("Info logging enabled")):(t.i("Info logging disabled"),t.setInfoLog(e))})},l.setEnabledVerboseLog=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread(function(){e?(t.setVerboseLog(e),t.i("Verbose logging enabled")):(t.i("Verbose logging disabled"),t.setVerboseLog(e))})},l.setEnabledManualSessionHandling=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread(function(){s.setManualSessionHandling(e)})},l.setEnabledEventSubmission=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread(function(){e?(s.setEnabledEventSubmission(e),t.i("Event submission enabled")):(t.i("Event submission disabled"),s.setEnabledEventSubmission(e))})},l.setCustomDimension01=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){a.validateDimension01(e,s.getAvailableCustomDimensions01())?s.setCustomDimension01(e):t.w("Could not set custom01 dimension value to '"+e+"'. Value not found in available custom01 dimension values")})},l.setCustomDimension02=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){a.validateDimension02(e,s.getAvailableCustomDimensions02())?s.setCustomDimension02(e):t.w("Could not set custom02 dimension value to '"+e+"'. Value not found in available custom02 dimension values")})},l.setCustomDimension03=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){a.validateDimension03(e,s.getAvailableCustomDimensions03())?s.setCustomDimension03(e):t.w("Could not set custom03 dimension value to '"+e+"'. Value not found in available custom03 dimension values")})},l.setFacebookId=function(e){void 0===e&&(e=""),n.performTaskOnGAThread(function(){a.validateFacebookId(e)&&s.setFacebookId(e)})},l.setGender=function(t){void 0===t&&(t=e.EGAGender.Undefined),n.performTaskOnGAThread(function(){a.validateGender(t)&&s.setGender(t)})},l.setBirthYear=function(e){void 0===e&&(e=0),n.performTaskOnGAThread(function(){a.validateBirthyear(e)&&s.setBirthYear(e)})},l.setEventProcessInterval=function(e){n.performTaskOnGAThread(function(){n.setEventProcessInterval(e)})},l.startSession=function(){if(s.isInitialized()){var e=n.createTimedBlock();e.async=!0,l.initTimedBlockId=e.id,e.block=function(){s.isEnabled()&&s.sessionIsStarted()&&n.endSessionAndStopQueue(),l.resumeSessionAndStartQueue()},n.performTimedBlockOnGAThread(e)}},l.endSession=function(){l.onStop()},l.onStop=function(){n.performTaskOnGAThread(function(){try{n.endSessionAndStopQueue()}catch(e){}})},l.onResume=function(){var e=n.createTimedBlock();e.async=!0,l.initTimedBlockId=e.id,e.block=function(){l.resumeSessionAndStartQueue()},n.performTimedBlockOnGAThread(e)},l.getCommandCenterValueAsString=function(e,n){return void 0===n&&(n=null),s.getConfigurationStringValue(e,n)},l.isCommandCenterReady=function(){return s.isCommandCenterReady()},l.addCommandCenterListener=function(e){s.addCommandCenterListener(e)},l.removeCommandCenterListener=function(e){s.removeCommandCenterListener(e)},l.getConfigurationsContentAsString=function(){return s.getConfigurationsContentAsString()},l.internalInitialize=function(){s.ensurePersistedStates(),i.setItem(s.DefaultUserIdKey,s.getDefaultId()),s.setInitialized(!0),l.newSession(),s.isEnabled()&&n.ensureEventQueueIsRunning()},l.newSession=function(){t.i("Starting a new session."),s.validateAndFixCurrentDimensions(),r.instance.requestInit(l.startNewSessionCallback)},l.startNewSessionCallback=function(e,r){if(e===c.Ok&&r){var o=0;if(r.server_ts){var a=r.server_ts;o=s.calculateServerTimeOffset(a)}r.time_offset=o,i.setItem(s.SdkConfigCachedKey,u.encode64(JSON.stringify(r))),s.instance.sdkConfigCached=r,s.instance.sdkConfig=r,s.instance.initAuthorized=!0}else e==c.Unauthorized?(t.w("Initialize SDK failed - Unauthorized"),s.instance.initAuthorized=!1):(e===c.NoResponse||e===c.RequestTimeout?t.i("Init call (session start) failed - no response. Could be offline or timeout."):e===c.BadResponse||e===c.JsonEncodeFailed||e===c.JsonDecodeFailed?t.i("Init call (session start) failed - bad response. Could be bad response from proxy or GA servers."):e!==c.BadRequest&&e!==c.UnknownResponseCode||t.i("Init call (session start) failed - bad request or unknown response."),null==s.instance.sdkConfig?null!=s.instance.sdkConfigCached?(t.i("Init call (session start) failed - using cached init values."),s.instance.sdkConfig=s.instance.sdkConfigCached):(t.i("Init call (session start) failed - using default init values."),s.instance.sdkConfig=s.instance.sdkConfigDefault):t.i("Init call (session start) failed - using cached init values."),s.instance.initAuthorized=!0);if(s.instance.clientServerTimeOffset=s.getSdkConfig().time_offset?s.getSdkConfig().time_offset:0,s.populateConfigurations(s.getSdkConfig()),!s.isEnabled())return t.w("Could not start session: SDK is disabled."),void n.stopEventQueue();n.ensureEventQueueIsRunning();var f=u.createGuid();s.instance.sessionId=f,s.instance.sessionStart=s.getClientTsAdjusted(),d.addSessionStartEvent();var v=n.getTimedBlockById(l.initTimedBlockId);null!=v&&(v.running=!1),l.initTimedBlockId=-1},l.resumeSessionAndStartQueue=function(){s.isInitialized()&&(t.i("Resuming session."),s.sessionIsStarted()||l.newSession())},l.isSdkReady=function(e,n,i){return void 0===n&&(n=!0),void 0===i&&(i=""),i&&(i+=": "),e&&!s.isInitialized()?(n&&t.w(i+"SDK is not initialized"),!1):e&&!s.isEnabled()?(n&&t.w(i+"SDK is disabled"),!1):!(e&&!s.sessionIsStarted())||(n&&t.w(i+"Session has not started yet"),!1)},l.initTimedBlockId=-1,l.methodMap={},l}();e.GameAnalytics=l}(s||(s={})),s.GameAnalytics.init();s.GameAnalytics.gaCommand;n.exports=s},{}],CustomMaterial:[function(e,n,t){"use strict";cc._RF.push(n,"c4328iO6IhNtrkVu14VI1Xh","CustomMaterial");var i=cc.renderer.renderEngine,s=i.renderer,r=i.gfx,o=i.Material,a={"2d":s.PARAM_TEXTURE_2D,"1f":s.PARAM_FLOAT,"2f":s.PARAM_FLOAT2,"4f":s.PARAM_FLOAT4};function c(e){var n=[{name:"texture",type:s.PARAM_TEXTURE_2D},{name:"color",type:s.PARAM_COLOR4}];if(e){var t=!0,i=!1,r=void 0;try{for(var o,c=e[Symbol.iterator]();!(t=(o=c.next()).done);t=!0){var u=o.value;for(var d in a)u.endsWith(d)&&n.push({name:u,type:a[d]})}}catch(e){i=!0,r=e}finally{try{!t&&c.return&&c.return()}finally{if(i)throw r}}}return n}var u=function(e){function n(n){e.call(this,!1);var t=new s.Pass(n.name);t.setDepth(!1,!1),t.setCullMode(r.CULL_NONE),t.setBlend(r.BLEND_FUNC_ADD,r.BLEND_SRC_ALPHA,r.BLEND_ONE_MINUS_SRC_ALPHA,r.BLEND_FUNC_ADD,r.BLEND_SRC_ALPHA,r.BLEND_ONE_MINUS_SRC_ALPHA);var i=new s.Technique(["transparent"],c(n.params),[t]);this._color={r:1,g:1,b:1,a:1},this._effect=new s.Effect([i],{color:this._color},[]),this._mainTech=i,this._texture=null}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var t={effect:{configurable:!0},texture:{configurable:!0},color:{configurable:!0}};return t.effect.get=function(){return this._effect},t.texture.get=function(){return this._texture},t.texture.set=function(e){this._texture!==e&&(this._texture=e,this._effect.setProperty("texture",e.getImpl()),this._texIds.texture=e.getId())},t.color.get=function(){return this._color},t.color.set=function(e){var n=this._color;n.r=e.r/255,n.g=e.g/255,n.b=e.b/255,n.a=e.a/255,this._effect.setProperty("color",n)},n.prototype.clone=function(){var e=new n;return e._mainTech.copy(this._mainTech),e.texture=this.texture,e.color=this.color,e.updateHash(),e},n.prototype.setParam=function(e,n){n instanceof cc.Texture2D?(this._effect.setProperty(e,n.getImpl()),this._texIds[e]=n.getId()):this._effect.setProperty(e,n)},Object.defineProperties(n.prototype,t),n}(o);n.exports=u,cc._RF.pop()},{}],GAPlugin:[function(e,n,t){"use strict";cc._RF.push(n,"63b2ezVBgpD3p2z0NtT/Gzf","GAPlugin");var i=e("gameanalytics"),s=e("GameEvent");cc.Class({extends:cc.Component,properties:{key:"game key",secret:"secret key",version:"0.0.1"},start:function(){i.GameAnalytics.configureAvailableResourceCurrencies(["coin"]),i.GameAnalytics.configureAvailableResourceItemTypes(["collect","item"]),i.GameAnalytics.configureAvailableCustomDimensions01(["star","revive"]),i.GameAnalytics.configureBuild(this.version),i.GameAnalytics.initialize(this.key,this.secret),s.GAME_START.push(this.onGameStart.bind(this)),s.GAME_OVER.push(this.onGameOver.bind(this)),s.REVIVE.push(this.onCoinChanged.bind(this)),i.GameAnalytics.addProgressionEvent(i.EGAProgressionStatus.Complete,"game","launch"),this.playTime=0,this.game=cc.find("Canvas").getComponent("GameController"),this.coin=this.game.getCoin()},onGameStart:function(){this.playTime++,i.GameAnalytics.addProgressionEvent(i.EGAProgressionStatus.Complete,"game","session","start_"+this.playTime);var e=this.game.getCoin(),n=e-this.coin;n>0&&(i.GameAnalytics.addResourceEvent(i.EGAResourceFlowType.Source,"coin",n,"collect","star"),this.coin=e)},onGameOver:function(){var e=this.game.getData();i.GameAnalytics.addProgressionEvent(i.EGAProgressionStatus.Complete,"game","session","end_"+this.playTime),i.GameAnalytics.addProgressionEvent(i.EGAProgressionStatus.Complete,"game","boss_"+Math.floor(e[0]/5),"stage_"+e[0],e[1])},onCoinChanged:function(e){e>=0||(i.GameAnalytics.addResourceEvent(i.EGAResourceFlowType.Sink,"coin",-e,"item","revive"),this.coin+=e)}}),cc._RF.pop()},{GameEvent:"GameEvent",gameanalytics:1}],GameController:[function(e,n,t){"use strict";cc._RF.push(n,"099be59GZ1AlZbTzZbDFge1","GameController");var i=e("GameEvent"),s=e("Profile"),r=0,o=0,a=0;cc.Class({extends:cc.Component,properties:{content:cc.Node,score:cc.Label,coin:cc.Label,stage:cc.Label,preBoss:cc.Animation,pixel:cc.Node,revive:cc.Node,price:0},onLoad:function(){i.resetAll(),s.load();for(var e=this.content,n=e.children[0],t=11;--t>0;){var r=cc.instantiate(n);e.addChild(r)}this.seq=cc.sequence(cc.fadeTo(.1,150),cc.fadeOut(.2))},reset:function(){for(var e=++o%5==0,n=this.content,t=n.children,s=t.length,a=this.count=(e?9:5)+Math.floor(3*Math.random()),c=0;c<s;++c){var u=t[c];u.active=c<a,u.color=cc.color("8DBF2C")}var d=this.stage;d.enabled=!0,d.node.color=e?cc.color(255,100,100):cc.color("FF9900"),d.string=e?"M\xe0n kh\xf3 "+Math.floor(o/5):"M\xe0n "+o,this.score.string=r,s=(t=d.node.children).length;var l=o%s-1;l<0&&(l=s-1);for(var f=0;f<s;f++){var v=t[f];v.active=!e||f>=l,v.color=cc.color(f<l?"FF9900":"281E5A")}t[l].runAction(cc.sequence(cc.scaleTo(.1,1.5),cc.scaleTo(.1,1),e?cc.tintTo(.1,255,100,100):cc.tintTo(.1,255,153,0),e&&cc.moveTo(.3,0,t[l].y))),i.invoke("RESET");var m=this.preBoss;e?(n.active=!1,m.node.active=!0,m.once("finished",this.onFinish.bind(this)),m.play(),i.invoke("PLAY_SOUND","preboss")):(m.node.active=!1,this.onFinish())},onFinish:function(){cc.find("Camera").on("touchstart",i.invoke.bind(i,"TAP")),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,i.invoke.bind(i,"TAP"),this),this.content.active=!0,i.invoke("START",this.count,o)},start:function(){i.HIT.push(this.onHit.bind(this)),i.GAME_OVER.push(this.onGameOver.bind(this)),i.FAILED.push(this.onFailed.bind(this)),i.COIN.push(this.onCoin.bind(this)),i.GAME_START.push(this.onGameStart.bind(this)),a=s.coin,this.coin.string=a,this.revive.active=!1},onCoin:function(){a++,this.coin.string=a},onRefuse:function(){i.invoke("REVIVE",0)},onRevive:function(){a-=this.price,this.coin.string=a,this.revive.active=!1,this.pixel.runAction(this.seq),i.invoke("REVIVE",-this.price)},onFailed:function(e){var n=this.revive;e<0&&a>=this.price&&(n.active=!0,n.scale=0,n.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.2,1)))),i.invoke("SHOW_REVIVE",n.active),this.pixel.runAction(this.seq)},onHit:function(){r++,this.score.string=r;var e=--this.count;if(this.content.children[e].color=cc.color("281E5A"),e)i.invoke("KNIFE");else{var n=o%5==0,t=this.stage;if(t.enabled=!1,n){var s=t.node.children,a=s.length-1;s[a].runAction(cc.sequence(cc.delayTime(1.3),cc.tintTo(.1,40,30,90),cc.moveTo(.3,106,s[a].y),cc.callFunc(this.onPostBoss.bind(this))))}else t.node.runAction(cc.sequence(cc.delayTime(1.7),cc.callFunc(this.reset.bind(this))));i.invoke("STAGE")}},onPostBoss:function(){var e=this.preBoss;e.once("finished",this.reset.bind(this)),e.play("postBoss"),i.invoke("PLAY_SOUND","endboss")},onGameOver:function(){s.set(r,a),this.revive.active=!1;var e=this.stage.node.children;e[e.length-1].x=106},getData:function(){return[o,r]},getCoin:function(){return a},onGameStart:function(){r=0,o=0}}),cc._RF.pop()},{GameEvent:"GameEvent",Profile:"Profile"}],GameEvent:[function(e,n,t){"use strict";cc._RF.push(n,"716c9eUsT1ET60gvtq5wPHB","GameEvent");var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n.exports={};s.invoke=function(e,n,t){var i=this[e];for(var s in i)i[s](n,t)},s.reset=function(e){if("object"==(void 0===e?"undefined":i(e)))for(var n in e)s[e[n]]=[];else s[e]=[]},s.list=["TAP","HIT","GAME_OVER","KNIFE","STAGE","START","GAME_START","RESET","PLAY_SOUND","FAILED","COIN","REVIVE","SHOW_REVIVE"],s.resetAll=function(){s.reset(s.list)},cc._RF.pop()},{}],Knife:[function(e,n,t){"use strict";cc._RF.push(n,"197e3g6PxxLp7J9YSfvQnMe","Knife");var i=e("GameEvent");cc.Class({extends:cc.Component,properties:{collisionAngle:9,sprites:[cc.SpriteFrame],glows:[cc.SpriteFrame],trees:[cc.SpriteFrame],earth:cc.SpriteFrame,earthglow:cc.SpriteFrame,dot:cc.Node},start:function(){var e=this.knife=cc.find("knife"),n=this.y=e.y,t=this.node;t.children[0].opacity=0,this.knifeList=t.children[2],this.obstacle=t.children[3],this.star=t.children[4],this.cover=t.children[6],this.revive=-1,i.TAP.push(this.onclick.bind(this)),i.KNIFE.push(this.onKnife.bind(this)),i.STAGE.push(this.onStage.bind(this)),i.START.push(this.onGameStart.bind(this)),i.RESET.push(this.reset.bind(this)),i.REVIVE.push(this.onRevive.bind(this)),i.SHOW_REVIVE.push(this.onShowRevive.bind(this)),this.seq1=cc.sequence(cc.moveTo(.1,0,t.y-430),cc.callFunc(this.onHit.bind(this))),this.seq2=cc.sequence(cc.moveBy(.1,0,30),cc.moveBy(.1,0,-30)),this.seq3=cc.sequence(cc.fadeTo(.1,200),cc.fadeOut(.1)),this.seq4=cc.sequence(cc.moveTo(.1,0,n),cc.callFunc(this.onResume.bind(this))),this.seq5=cc.sequence(cc.fadeIn(.3),cc.delayTime(1),cc.fadeOut(.2)),this.reset()},reset:function(){var e=this.node;e.active=!0,e.opacity=0,this.knife.active=!1,this.pause=!0},onGameStart:function(e,n){var t=this.node;t.opacity=255;var i=t.children[5],s=Math.floor(Math.random()*this.sprites.length);i.getComponent(cc.Sprite).spriteFrame=this.sprites[s],t.children[1].getComponent(cc.Sprite).spriteFrame=this.glows[s],this.cover.setContentSize(i),i.scale=0,t.scale=1,this.rotList=[],i.runAction(cc.sequence(cc.scaleTo(.2,1.15),n>1&&cc.callFunc(this.spawnObstacle.bind(this,e)),cc.callFunc(this.spawnStar.bind(this)),cc.scaleTo(.1,1)))},spawnObstacle:function(e){e=11-e;var n=this.collisionAngle,t=Math.floor(360/n),s=0,r=.52*this.node.width,o=this.obstacle,a=o.children[0];a.active=!0;for(var c=this.rotList;--e>0;){(s+=5+Math.floor(Math.random()*t))>t&&(s-=t);var u=s*n,d=cc.instantiate(a);d.parent=o,d.rotation=-u-135,c.push((u+90)%360),u*=Math.PI/180,d.setPosition(r*Math.cos(u),r*Math.sin(u))}a.active=!1,i.invoke("PLAY_SOUND","targetappear")},spawnStar:function(){var e=Math.floor(7*(Math.random()-.5)),n=this.collisionAngle,t=Math.floor(360/n),i=-4,s=.6*this.node.width,r=this.star,o=r.children[0];o.active=!0;for(var a=this.rotList,c=this.starList=[],u=2*this.collisionAngle;e>0;){(i+=4)>t&&(i-=t);var d=i*n,l=(d+90)%360,f=!0,v=!1,m=void 0;try{for(var h,g=a[Symbol.iterator]();!(f=(h=g.next()).done);f=!0){var p=h.value;Math.abs(l-p)<u&&(l=-1)}}catch(e){v=!0,m=e}finally{try{!f&&g.return&&g.return()}finally{if(v)throw m}}if(!(l<0)){var S=!0,y=!1,E=void 0;try{for(var A,b=c[Symbol.iterator]();!(S=(A=b.next()).done);S=!0){var C=A.value;Math.abs(l-C)<u&&(l=-1)}}catch(e){y=!0,E=e}finally{try{!S&&b.return&&b.return()}finally{if(y)throw E}}--e;var T=cc.instantiate(o);T.parent=r,T.rotation=90-d,c.push(T),d*=Math.PI/180,T.setPosition(s*Math.cos(d),s*Math.sin(d))}}o.active=!1;var G=this.knife;G.active=!0,G.rotation=0,G.setPosition(0,this.y-200),G.runAction(this.seq4)},onFailed:function(){this.clear(),this.reset(),this.revive=-1,i.invoke("GAME_OVER")},onRevive:function(e){this.knife.stopAllActions(),e<0?(this.node.active=!0,this.revive=0,this.onKnife()):this.onFailed()},onShowRevive:function(e){this.node.active=!e,this.knife.runAction(cc.sequence(cc.spawn(cc.rotateBy(1,1300),cc.jumpTo(1,0,this.y-2e3,0,1)),cc.delayTime(e?2:.1),cc.callFunc(this.onFailed.bind(this))))},onHit:function(){for(var e=this.rotList,n=this.node,t=n.rotation,s=this.knife;t<0;)t+=360;t=Math.floor(t)%360;var r=this.collisionAngle,o=!0,a=!1,c=void 0;try{for(var u,d=e[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var l=u.value;if(Math.abs(l-t)<r){var f=this.dot;return f.opacity=150,f.scale=0,f.setPosition(s),f.runAction(cc.spawn(cc.scaleTo(.2,.7),cc.fadeOut(.3))),i.invoke("FAILED",this.revive),void i.invoke("PLAY_SOUND","gameover")}}}catch(e){a=!0,c=e}finally{try{!o&&d.return&&d.return()}finally{if(a)throw c}}e.push(t),i.invoke("PLAY_SOUND","hit"),e=this.starList;var v=!0,m=!1,h=void 0;try{for(var g,p=e[Symbol.iterator]();!(v=(g=p.next()).done);v=!0){var S=g.value;if(!(S.opacity<255)){var y=(90-S.rotation+90)%360;if(Math.abs(y-t)<r){i.invoke("COIN"),S.runAction(cc.sequence(cc.spawn(cc.scaleTo(.3,2),cc.fadeOut(.3)),cc.callFunc(i.invoke.bind(i,"PLAY_SOUND","coin"))));break}}}}catch(e){m=!0,h=e}finally{try{!v&&p.return&&p.return()}finally{if(m)throw h}}s=cc.instantiate(s),i.invoke("HIT"),s.parent=this.knifeList,s.rotation=-t,s.setPosition(n.convertToNodeSpaceAR(s)),this.cover.stopAllActions(),n.runAction(this.seq2),this.cover.runAction(this.seq3)},onStage:function(){this.knife.active=!1,this.node.runAction(cc.sequence(cc.scaleTo(.15,1.2),cc.callFunc(this.onEarth.bind(this)),cc.scaleTo(.1,1),cc.delayTime(1),cc.scaleTo(.15,1.2),cc.scaleTo(.1,0),cc.callFunc(this.clear.bind(this))))},clear:function(){for(var e=this.obstacle.children,n=e.length,t=1;t<n;++t)e[t].destroy();n=(e=this.star.children).length;for(var i=1;i<n;++i)e[i].destroy();n=(e=this.knifeList.children).length;for(var s=0;s<n;++s)e[s].destroy()},onEarth:function(){var e=this.node.children,n=e[5].getComponent(cc.Sprite),t=e[1].getComponent(cc.Sprite);n.spriteFrame=this.earth,t.spriteFrame=this.earthglow,e[0].runAction(this.seq5),i.invoke("PLAY_SOUND","unlock")},onKnife:function(){var e=this.knife;e.rotation=0,e.setPosition(0,this.y-200),e.setSiblingIndex(1),e.runAction(this.seq4);var n=this.trees,t=Math.floor(Math.random()*n.length);e.getComponent(cc.Sprite).spriteFrame=n[t]},onResume:function(){this.pause=!1},onclick:function(){if(!this.pause){this.pause=!0;var e=this.knife;e.stopAllActions(),e.runAction(this.seq1)}}}),cc._RF.pop()},{GameEvent:"GameEvent"}],MainMenu:[function(e,n,t){"use strict";cc._RF.push(n,"b8135hFJItFk5UuF8W+b7JH","MainMenu");var i=e("Profile"),s=e("GameEvent");cc.Class({extends:cc.Component,properties:{playBtn:cc.Node,bestScore:cc.Label,mainMenu:cc.Node,actionPhase:cc.Node},start:function(){this.playBtn.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,1.1),cc.scaleTo(.3,.9),cc.scaleTo(.3,1.2),cc.scaleTo(.3,1),cc.delayTime(2)))),this.onGameOver(),s.GAME_OVER.push(this.onGameOver.bind(this))},switch:function(e){this.mainMenu.active=e,this.actionPhase.active=!e},onGameOver:function(){this.bestScore.string=i.bestScore,this.switch(!0)},play:function(){this.switch(!1),s.invoke("GAME_START"),this.node.getComponent("GameController").reset()}}),cc._RF.pop()},{GameEvent:"GameEvent",Profile:"Profile"}],MaterialLoader:[function(e,n,t){"use strict";cc._RF.push(n,"4ebad0YGDtFcL8Lu2iG97KY","MaterialLoader");var i=e("CustomMaterial");cc.Class({extends:cc.Component,properties:{effect:"blend"},init:function(n){return this.target=this.node.getComponent(cc.RenderComponent),this.shader=e(n),this.material=new i(this.shader),this.targetMaterial=this.target._spriteMaterial||this.target.getMaterial(),this.material},onDisable:function(){this.target._spriteMaterial=this.targetMaterial,this.target._activateMaterial(!0)},onEnable:function(){var e=this.material||this.init(this.effect);e.color=this.node.color,e.texture=this.targetMaterial.texture,this.shader.start&&this.shader.start(e);var n=this.target;n._spriteMaterial?n._spriteMaterial=e:n._material=e,n._activateMaterial(!0),!this.shader.update&&(this.update=void 0)},set:function(e,n){this.shader.set&&this.shader.set(this.material,e,n)},update:function(e){this.shader.update(this.material,e)&&(this.enabled=!1)}}),cc._RF.pop()},{CustomMaterial:"CustomMaterial"}],Profile:[function(e,n,t){"use strict";cc._RF.push(n,"3d896j/nxxNepCiuhusxLaZ","Profile");var i=n.exports={};i.load=function(){this.bestScore=cc.sys.localStorage.getItem("htx_bestScore")||0,this.coin=cc.sys.localStorage.getItem("htx_coin")||0,cc.log("Load Profile"),i.load=function(){}},i.set=function(e,n){this.bestScore<e&&(this.bestScore=e,cc.sys.localStorage.setItem("htx_bestScore",e)),this.coin=n,cc.sys.localStorage.setItem("htx_coin",n)},cc._RF.pop()},{}],SoundController:[function(e,n,t){"use strict";cc._RF.push(n,"45f88TWqnxPeL7Z9422YUpB","SoundController");var i=e("GameEvent");cc.Class({extends:cc.Component,properties:{count:1,volume:1,clips:{type:cc.AudioClip,default:[]}},start:function(){this.audio=[];for(var e=this.count,n=0;n<e;++n){var t=new cc.Audio;t.setLoop(!1),t.setVolume(this.volume),this.audio.push(t)}this.id=0,i.PLAY_SOUND.push(this.play.bind(this))},play:function(e){var n=(this.id+1)%this.audio.length;this.id=n;var t=this.audio[n];t.stop(),t.src=this.clips.find(function(n){return n.name==e}),t.setCurrentTime(0),t.play()}}),cc._RF.pop()},{GameEvent:"GameEvent"}],SpritePicker:[function(e,n,t){"use strict";cc._RF.push(n,"04962nkfrpA94dKE1dFzXcz","SpritePicker");var i=e("GameEvent");cc.Class({extends:cc.Component,properties:{frame:cc.SpriteFrame},start:function(){this.sprite=this.node.getComponent(cc.Sprite),i.HIT.push(this.onHit.bind(this))},onHit:function(){this.sprite.spriteFrame=this.frame}}),cc._RF.pop()},{GameEvent:"GameEvent"}],Target:[function(e,n,t){"use strict";cc._RF.push(n,"8c655DyoilHm6VbA/Dn1WAf","Target");var i=e("GameEvent"),s=0;cc.Class({extends:cc.Component,properties:{},start:function(){i.GAME_OVER.push(this.onGameOver.bind(this)),i.START.push(this.reset.bind(this))},reset:function(){var e=Math.floor(s++/5),n=0;s>1&&(n=s%5==0?3+Math.floor(5*Math.random()):Math.floor(3*Math.random())),this.node.runAction(cc.repeatForever(this["seq"+n](.1*Math.min(e,10))))},seq0:function(e){return cc.rotateBy(5-e,360)},seq1:function(e){return cc.rotateBy(5-e,-360)},seq2:function(e){return cc.sequence(cc.rotateBy(3-e,200),cc.rotateBy(2-e,-100))},seq3:function(e){return cc.sequence(cc.rotateBy(2-e,200),cc.rotateBy(2-e,-200),cc.rotateBy(2-e,200),cc.rotateBy(2-e,-500))},seq4:function(e){return cc.sequence(cc.rotateBy(4-e,100),cc.rotateBy(2-e,500))},seq5:function(e){return cc.sequence(cc.rotateBy(4-e,350),cc.rotateBy(4-e,-350))},seq6:function(e){return e*=.5,cc.sequence(cc.rotateBy(1-e,50),cc.rotateBy(1-e,-50),cc.rotateBy(1-e,50),cc.rotateBy(1-e,-50),cc.rotateBy(1-e,50),cc.rotateBy(1-e,-100))},seq7:function(e){return cc.sequence(cc.rotateBy(2-e,200),cc.rotateBy(2-e,300),cc.rotateBy(2-e,400),cc.rotateBy(2-e,500),cc.rotateBy(2-e,600),cc.rotateBy(2-e,700),cc.rotateBy(2-e,800),cc.rotateBy(2-e,700),cc.rotateBy(2-e,600),cc.rotateBy(2-e,500),cc.rotateBy(2-e,400),cc.rotateBy(2-e,300))},onGameOver:function(){s=0}}),cc._RF.pop()},{GameEvent:"GameEvent"}],blend:[function(e,n,t){"use strict";cc._RF.push(n,"75b5au594dMtIm9HlpnX9mQ","blend");var i={name:"blend",vert:"\n    uniform mat4 viewProj;\n    uniform mat4 model;\n    attribute vec3 a_position;\n    attribute vec2 a_uv0;\n    varying vec2 uv0;\n    \n    void main () {\n        mat4 mvp;\n        mvp = viewProj * model;\n        vec4 pos = mvp * vec4(a_position, 1);\n        gl_Position = pos;\n        uv0 = a_uv0;\n    }",frag:"\n    uniform sampler2D texture;\n    uniform vec4 color;\n    uniform float a1f;\n    varying vec2 uv0;\n\n    void main () {\n        vec2 uv = uv0 - 0.5;\n        float r = uv.x * uv.x + uv.y * uv.y;\n        float a = texture2D(texture, uv0).a + 0.001;\n        a = step(a, a1f) * step(r, 0.23);\n        gl_FragColor = vec4(color.rgb, 0.23 * a);\n    }",params:["a1f"],set:function(e,n){e.setParam("a1f",.13*n)}};cc.game.once(cc.game.EVENT_ENGINE_INITED,function(){cc.renderer._forward._programLib.define(i.name,i.vert,i.frag,[])}),n.exports=i,cc._RF.pop()},{}]},{},["CustomMaterial","GAPlugin","GameController","GameEvent","Knife","MainMenu","MaterialLoader","Profile","SoundController","SpritePicker","Target","blend"]);